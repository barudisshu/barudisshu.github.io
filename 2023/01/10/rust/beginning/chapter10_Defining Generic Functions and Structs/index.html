<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><title>ruståŸºç¡€å…¥é—¨[10] - Defining Generic Functions and Structs</title>
<link rel="stylesheet" href="/css/layout.css">
<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="/css/vendors/rabbit-lyrics.css">
<link rel="shortcut icon" href="/img/favicon.ico"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•" type="application/atom+xml">
</head><body><header class="base-menu"><div class="menu-wrapper"><div class="menu-layout-bg"></div><nav class="menu-content"><ul class="menu-list"><li class="menu-item"><a class="menu-link" href="/">ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•</a></li><li class="menu-item"><a class="menu-link" href="/archives/">Archives</a></li><li class="menu-item"><a class="menu-link" target="_blank" rel="noopener" href="http://weibo.com/u/2360401155">Weibo</a></li><li class="menu-item"><a class="menu-link" href="/about">About</a></li><li class="menu-item"><a class="menu-link" href="/atom.xml">Rss</a></li></ul></nav></div></header><header class="base-mobile-menu"><div class="mobile-menu-wrapper"><div class="menu-layout-bg"></div><nav class="menu-content"><ul class="menu-list"><li class="menu-item"><a class="menu-link" href="/">ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•</a></li><li class="menu-item"><a class="menu-link" href="/archives/">Archives</a></li><li class="menu-item"><a class="menu-link" target="_blank" rel="noopener" href="http://weibo.com/u/2360401155">Weibo</a></li><li class="menu-item"><a class="menu-link" href="/about">About</a></li><li class="menu-item"><a class="menu-link" href="/atom.xml">Rss</a></li></ul></nav><div class="toggle-menu" id="mobile-menu-toggle"><span class="menu-bar"></span><span class="menu-bar"> </span><span class="menu-bar"></span></div></div></header><div class="base-content"><div class="base-content-main"><article class="article-main"><h1 class="article-title">ruståŸºç¡€å…¥é—¨[10] - Defining Generic Functions and Structs</h1><div class="article-meta"><p class="meta-item meta-time"><span class="meta-item-title"></span><i class="icon-calendar"> </i>2023-01-10</p><p class="meta-item meta-tag"><span class="meta-item-title"></span><i class="icon-tag"> </i><a class="tag-link" href="/tags/rust/">rust</a></p><p class="meta-item meta-category"><span class="meta-item-title"></span><i class="icon-bookmark"> </i><a class="category-link" href="/categories/learning/">learning</a></p></div><div class="article-content"><p>æœ¬ç« è¦†ç›–æœ‰ï¼š</p>
<ul>
<li>å¦‚ä½•å®šä¹‰å•ç‹¬çš„å‡½æ•°ï¼Œä½¿å¾—è°ƒç”¨è€…å¯ä»¥å¤„ç†ä¸åŒçš„æ•°æ®ç±»å‹</li>
<li>æ³›å‹å‡½æ•°å¦‚ä½•ä½¿ç”¨ç±»å‹æ¨å¯¼æ¥é¿å…æŒ‡å®šå…·ä½“ç±»å‹</li>
<li>å¦‚ä½•åœ¨structã€tuple-structã€enumå®ç°å„ç§æ³›å‹ç±»å‹</li>
<li>å¦‚ä½•ä½¿ç”¨ä¸¤ä¸ªå¸¸è§çš„æšä¸¾ç±»å‹ï¼ŒOptionå’ŒResult</li>
<li>æ ‡å‡†å‡½æ•°å¯¹Optionå’ŒResultçš„å¤„ç†</li>
</ul>
<span id="more"></span>
<h2 id="Need-of-Generic-Functions"><a class="header-anchor" href="#Need-of-Generic-Functions">Â¶</a>Need of Generic Functions</h2>
<p>Rustæä¾›ä¸€ä¸ªé™æ€ç±»å‹æ£€æŸ¥ï¼Œæ‰€ä»¥å®šä¹‰å‡½æ•°çš„å‚æ•°å¿…é¡»æ˜¯ç¡®åˆ‡çš„ç±»å‹ï¼Œä¾‹å¦‚<code>fn square_root(x: f32) -&gt; f32</code>ï¼Œè°ƒç”¨æ—¶å¿…é¡»ä¼ é€’ä¸€ä¸ªç¡®åˆ‡çš„å‚æ•°ï¼Œä¾‹å¦‚<code>square_root(45.2f32)</code>ï¼Œæˆ–æ˜¾ç¤ºè½¬æ¢ä¸ºå®ƒæ‰€éœ€è¦çš„å‚æ•°<code>square_root(45.2f64 as f32)</code>ã€‚ä½ ä¸èƒ½ä¼ é€’ä¸åŒçš„ç±»å‹ã€‚</p>
<p>è¿™ä¸è®ºæ˜¯å†™ä»£ç ã€è¿˜æ˜¯è°ƒç”¨ä»£ç éƒ½å¸¦æ¥äº†ä¸æ–¹ä¾¿ã€‚ç”šè‡³äºRustæœ‰å¾ˆå¤šä¸åŒçš„æ•´å‹ç±»å‹ï¼Œå½“å†™ä¸€ä¸ªå‡½æ•°ï¼Œæ¯æ¬¡éƒ½è¦å¤„ç†é€‰æ‹©å“ªä¸€ç§ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå½“ä½ ç”¨<code>i16</code>ç±»å‹ä½œä¸ºå‚æ•°ï¼Œä½†æ¯æ¬¡éƒ½ä¼ é€’äº†<code>i32</code>ç±»å‹ï¼Œè¿™è¦æ±‚æˆ‘ä»¬é‡æ–°å®šä¹‰æˆ‘ä»¬çš„å‡½æ•°ã€‚</p>
<p>å¦å¤–ï¼Œå‡½æ•°ä¼šè¢«ä½œä¸ºæ¨¡å—åœ¨å…¶å®ƒåœ°æ–¹è°ƒç”¨ï¼Œè¿™ä¹Ÿä¸èƒ½æ»¡è¶³æ¯ä¸ªä½¿ç”¨è€…ã€‚</p>
<h2 id="Defining-and-Using-Generic-Functions"><a class="header-anchor" href="#Defining-and-Using-Generic-Functions">Â¶</a>Defining and Using Generic Functions</h2>
<p>æœ€ç¬¨çš„åŠæ³•æ˜¯ç¼–å†™æ³›å‹å‡½æ•°ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Library code</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">f</span>&lt;T&gt;(ch: <span class="type">char</span>, num1: T, num2: T) <span class="punctuation">-&gt;</span> T &#123;</span><br><span class="line">    <span class="keyword">if</span> ch == <span class="string">&#x27;a&#x27;</span> &#123; num1 &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; num2 &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">a</span>: <span class="type">i16</span> = f::&lt;<span class="type">i16</span>&gt;(<span class="string">&#x27;a&#x27;</span>, <span class="number">37</span>, <span class="number">41</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">b</span>: <span class="type">f64</span> = f::&lt;<span class="type">f64</span>&gt;(<span class="string">&#x27;b&#x27;</span>, <span class="number">37.2</span>, <span class="number">41.1</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>, a, b);</span><br></pre></td></tr></table></figure>
<p>æ³›å‹å‚æ•°ç±»å‹å®šä¹‰åœ¨å‡½æ•°ååé¢ï¼Œç”±å°–æ‹¬å·å›Šæ‹¬ï¼Œå®ƒå°±æ˜¯å‡½æ•°çš„ç±»å‹å‚æ•°å£°æ˜ã€‚å®ƒè¡¨è¿°å£°æ˜çš„ä¸æ˜¯ä¸€ä¸ªå…·ä½“å‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªæ³›å‹å‡½æ•°ï¼Œè¯¥å‡½æ•°çš„æ³›å‹å‚æ•°ç±»å‹ï¼Œä»…åœ¨ç¼–è¯‘æœŸç¡®å®šã€‚</p>
<p>å‚æ•°<code>T</code>çš„å®šä¹‰èŒƒå›´ä»…é™äºå‡½æ•°å®šä¹‰å†…ã€‚å®é™…ä¸Šä»…ä¼šå‡ºç°åœ¨3ä¸ªåœ°æ–¹ï¼Œå‡½æ•°ç­¾åï¼Œä»¥åŠå‡½æ•°è¯­å¥ä½“å†…éƒ¨è°ƒç”¨ï¼Œä¸ä¼šåœ¨å…¶å®ƒåœ°æ–¹å‡ºç°ã€‚</p>
<p>æ³›å‹å‡½æ•°çš„è°ƒç”¨ï¼Œéœ€è¦å¸¦ä¸Šç±»å‹å‚æ•°ï¼Œç±»å‹å‚æ•°å°±æ˜¯å…·ä½“çš„ç±»å‹æ›¿æ¢è¿™ä¸ª<code>T</code>å³å¯ã€‚å¦‚è¿™é‡Œçš„<code>f::&lt;i16&gt;</code>ã€<code>f::&lt;f64&gt;</code>ã€‚</p>
<p>Cè¯­è¨€æ²¡æœ‰æ³›å‹ç±»å‹çš„æ¦‚å¿µï¼Œä½†C++æœ‰ï¼šå®ƒä½¿ç”¨äº†å‡½æ•°æ¨¡æ¿ã€‚</p>
<h2 id="Inferring-the-Parametric-Types"><a class="header-anchor" href="#Inferring-the-Parametric-Types">Â¶</a>Inferring the Parametric Types</h2>
<p>ä¸Šé¢çš„ä»£ç å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–ï¼Œ</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Library code</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">f</span>&lt;T&gt;(ch: <span class="type">char</span>, num1: T, num2: T) <span class="punctuation">-&gt;</span> T &#123;</span><br><span class="line">    <span class="keyword">if</span> ch == <span class="string">&#x27;a&#x27;</span> &#123; num1 &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; num2 &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">a</span>: <span class="type">i16</span> = <span class="title function_ invoke__">f</span>(<span class="string">&#x27;a&#x27;</span>, <span class="number">37</span>, <span class="number">41</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">b</span>: <span class="type">f64</span> = <span class="title function_ invoke__">f</span>(<span class="string">&#x27;b&#x27;</span>, <span class="number">37.2</span>, <span class="number">41.1</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>, a, b);</span><br></pre></td></tr></table></figure>
<p>è¿™é‡ŒæŠŠ<code>::&lt;i16&gt;</code>å’Œ<code>::&lt;f64&gt;</code>ç§»é™¤äº†ï¼Œä»¥åŠå¾—åˆ°ç­‰ä»·çš„ç»“æœã€‚å®é™…ä¸Šï¼Œç¼–è¯‘å™¨åœ¨è§£æä¸€ä¸ªæ³›å‹å‡½æ•°çš„è°ƒç”¨æ—¶ï¼Œä½¿ç”¨äº†å‚æ•°çš„ç±»å‹æ¥ç¡®å®šç±»å‹ã€‚</p>
<p>è¯´ç™½äº†ï¼Œå‚æ•°åŒ–ç±»å‹(parametric type)æ˜¯ç”±æ³›å‹å‡½æ•°è°ƒç”¨çš„è¡¨è¾¾å¼æ¨æ–­(inferred)å‡ºæ¥çš„ã€‚</p>
<p>å½“ç„¶ï¼Œè¢«ä½¿ç”¨çš„ç±»å‹å¿…é¡»æ˜¯ä¸€è‡´çš„ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">f</span>&lt;T&gt;(a: T, _b: T) <span class="punctuation">-&gt;</span> T &#123; a &#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">_a</span> = <span class="title function_ invoke__">f</span>(<span class="number">12u8</span>, <span class="number">13u8</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">_b</span> = <span class="title function_ invoke__">f</span>(<span class="number">12i64</span>, <span class="number">13i64</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">_c</span> = <span class="title function_ invoke__">f</span>(<span class="number">12i16</span>, <span class="number">13u16</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">_d</span>: <span class="type">i32</span> = <span class="title function_ invoke__">f</span>(<span class="number">12i16</span>, <span class="number">13i16</span>);</span><br></pre></td></tr></table></figure>
<p>æœ€åä¸€ä¸ªå‡ºç°ç¼–è¯‘é”™è¯¯ï¼Œè™½ç„¶å‚æ•°ä¼ é€’äº†ç›¸åŒçš„ç±»å‹ï¼Œä½†å‡½æ•°è¿”å›çš„ç±»å‹ä¸åŒ¹é…å˜é‡å£°æ˜ã€‚</p>
<p>å¦‚æœæœ‰å‡ ä¸ªä¸åŒçš„ç±»å‹éœ€è¦å‚æ•°åŒ–ï¼Œä½ å¯ä»¥æŒ‡å®šæ³›å‹å‡½æ•°çš„å¤šä¸ªç±»å‹å‚æ•°ã€‚</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">f</span>&lt;Param1, Param2&gt;(_a: Param1, _b: Param2) &#123;&#125;</span><br><span class="line"><span class="title function_ invoke__">f</span>(<span class="string">&#x27;a&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">f</span>(<span class="number">12.56</span>, <span class="string">&quot;Hello&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">f</span>((<span class="number">3</span>, <span class="string">&#x27;a&#x27;</span>), [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]);</span><br></pre></td></tr></table></figure>
<h2 id="Defining-and-Using-Generic-Structs"><a class="header-anchor" href="#Defining-and-Using-Generic-Structs">Â¶</a>Defining and Using Generic Structs</h2>
<p>å‚æ•°åŒ–ç±»å‹ä¹Ÿé€‚ç”¨äºå£°æ˜æ³›å‹ç»“æ„ä½“å’Œæ³›å‹å…ƒç»„-ç»“æ„ä½“(tuple-struct)ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">S</span>&lt;T1, T2&gt; &#123;</span><br><span class="line">	c: <span class="type">char</span>,</span><br><span class="line">	n1: T1,</span><br><span class="line">	n2: T1,</span><br><span class="line">	n3: T2,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">_s</span> = S &#123; c: <span class="string">&#x27;a&#x27;</span>, n1: <span class="number">34</span>, n2: <span class="number">782</span>, n3: <span class="number">0.02</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SE</span>&lt;T1, T2&gt; (<span class="type">char</span>, T1, T1, T2);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">_se</span> = <span class="title function_ invoke__">SE</span> (<span class="string">&#x27;a&#x27;</span>, <span class="number">34</span>, <span class="number">782</span>, <span class="number">0.02</span>);</span><br></pre></td></tr></table></figure>
<p>ç»“æ„ä½“å’Œå…ƒç»„-ç»“æ„ä½“çš„ç±»å‹å‚æ•°å£°æ˜ï¼Œå’Œæ³›å‹å‡½æ•°çš„å£°æ˜ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨åç§°åé¢å¸¦ä¸Šç±»å‹å‚æ•°å£°æ˜ã€‚</p>
<p>å½“ç„¶ä¹Ÿå¯ä»¥æ˜¾å¼æŒ‡å®šç±»å‹å‚æ•°çš„å…·ä½“ç±»å‹ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">S</span>&lt;T1, T2&gt; &#123;</span><br><span class="line">	c: <span class="type">char</span>,</span><br><span class="line">	n1: T1,</span><br><span class="line">	n2: T1,</span><br><span class="line">	n3: T2,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">_s</span> = S::&lt;<span class="type">u16</span>, <span class="type">f32</span>&gt; &#123; c: <span class="string">&#x27;a&#x27;</span>, n1: <span class="number">34</span>, n2: <span class="number">782</span>, n3: <span class="number">0.02</span> &#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SE</span>&lt;T1, T2&gt; (<span class="type">char</span>, T1, T1, T2);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">_se</span> = SE::&lt;<span class="type">u16</span>, <span class="type">f32</span>&gt; (<span class="string">&#x27;a&#x27;</span>, <span class="number">34</span>, <span class="number">782</span>, <span class="number">0.02</span>);</span><br></pre></td></tr></table></figure>
<p>Cè¯­è¨€æ²¡æœ‰æ³›å‹ç»“æ„ä½“ï¼Œä½†C++æä¾›äº†ï¼šç±»æ¨¡æ¿å’Œç»“æ„æ¨¡æ¿ã€‚</p>
<h2 id="Genericity-Mechanics"><a class="header-anchor" href="#Genericity-Mechanics">Â¶</a>Genericity Mechanics</h2>
<p>è¦ç†è§£æ³›åŒ–çš„å†…éƒ¨æœºåˆ¶ï¼Œåº”è¯¥å…ˆçœ‹ç¼–è¯‘å™¨è¿™ä¸ªè§’è‰²ã€‚å®é™…ä¸Šï¼Œæ¦‚å¿µä¸Šæ¥è¯´ï¼Œæ³›å‹ä»£ç çš„ç¼–è¯‘å‡ºç°åœ¨å‡ ä¸ªé˜¶æ®µã€‚</p>
<p>è®©æˆ‘ä»¬è·Ÿéšç¼–è¯‘æœºåˆ¶çš„åŸºæœ¬æ¦‚å¿µï¼Œæä¾›ä¸€ä¸‹ä»£ç ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">swap</span>&lt;T1, T2&gt;(a: T1, b: T2) <span class="punctuation">-&gt;</span> (T2, T1) &#123; (b, a) &#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="title function_ invoke__">swap</span>(<span class="number">3i16</span>, <span class="number">4u16</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">y</span> = <span class="title function_ invoke__">swap</span>(<span class="number">5f32</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="built_in">print!</span>(<span class="string">&quot;&#123;:?&#125; &#123;:?&#125;&quot;</span>, x, y);</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€é˜¶æ®µï¼Œæºç è¢«æµè§ˆï¼Œæ¯æ¬¡ç¼–è¯‘å™¨æŸ¥æ‰¾ä¸€ä¸ªæ³›å‹å‡½æ•°å£°æ˜(è¿™é‡Œçš„æ˜¯<code>swap</code>å‡½æ•°)ï¼Œç¼–è¯‘å™¨åŠ è½½è¯¥å‡½æ•°çš„æ•°æ®ç»“æ„ï¼Œæ£€æŸ¥æ³›å‹ä»£ç æœ‰æ²¡æœ‰è¯­æ³•é”™è¯¯ã€‚</p>
<p>ç¬¬äºŒé˜¶æ®µï¼Œæºç å†æ¬¡è¢«æµè§ˆï¼Œç¼–è¯‘å™¨ç»Ÿè®¡æ³›å‹å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°ï¼Œå¹¶åŠ è½½è¯¥å‡½æ•°çš„ç»“æ„å…³è”å…³ç³»â€”â€”æ³›å‹å£°æ˜çš„å†…éƒ¨å“åº”å’Œä½¿ç”¨è¿›è¡Œå…³è”ï¼Œè¿™é˜¶æ®µåœ¨ç±»å‹æ£€æŸ¥å’Œå“åº”åˆæ³•çš„å‰æä¸‹è¿›è¡Œã€‚</p>
<p>åœ¨è¿™ä¸¤ä¸ªé˜¶æ®µä¸‹ï¼Œç¼–è¯‘å™¨è·å¾—äº†ä¸€ä¸ªæ³›å‹å‡½æ•°<code>swap</code>ï¼Œä¸€ä¸ª<code>main</code>å‡½æ•°ï¼Œä»¥åŠ<code>swap</code>å‡½æ•°çš„å¼•ç”¨ã€‚</p>
<p>ç¬¬ä¸‰é˜¶æ®µï¼Œæ‰€æœ‰æ³›å‹å‡½æ•°çš„è°ƒç”¨è¢«è¯»å–(è¿™é‡Œçš„ä¾‹å­ï¼Œswapè°ƒç”¨äº†ä¸¤æ¬¡)ã€‚æ¯æ¬¡è°ƒç”¨ï¼Œç¡®å®šä¸€ä¸ªå…·ä½“çš„å“åº”ç±»å‹çš„å®šä¹‰ã€‚è¿™ä¸ªå…·ä½“ç±»å‹å¯èƒ½åœ¨è°ƒç”¨çš„åœ°æ–¹æ˜¾å¼è·å–ï¼Œåˆæˆ–è€…æœ‰å‚æ•°çš„è¡¨è¾¾å¼æ¨æ–­å‡ºæ¥ã€‚ä¾‹å¦‚è¿™é‡Œä¾‹å­ï¼Œç¬¬ä¸€å¤„è°ƒç”¨swapï¼Œå‚æ•°<code>T1</code>å…³è”çš„ç±»å‹æ˜¯<code>i16</code>ï¼Œ<code>T2</code>å…³è”çš„ç±»å‹æ˜¯<code>u16</code>ï¼›ä»¥æ­¤ç±»æ¨â€¦</p>
<p>ç¡®å®šäº†å…·ä½“æ³›å‹å‚æ•°ç±»å‹åï¼Œä¸€ä¸ªç¡®å®šç±»å‹ç‰ˆæœ¬çš„å‡½æ•°è¢«ç”Ÿæˆã€‚æ¯ä¸ªæ³›å‹å‡½æ•°çš„è°ƒç”¨ï¼Œéƒ½ä¼šæ›¿æ¢åˆ°å…·ä½“ç”Ÿæˆçš„å‡½æ•°ä¸Šã€‚</p>
<p>ä¾‹å¦‚ï¼Œå†…éƒ¨ç”Ÿæˆçš„Rustä»£ç ä¸ºï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">swap_i16_u16</span>(a: <span class="type">i16</span>, b: <span class="type">u16</span>) <span class="punctuation">-&gt;</span> (<span class="type">u16</span>, <span class="type">i16</span>) &#123; (b, a) &#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">swap_f32_bool</span>(a: <span class="type">f32</span>, b: <span class="type">bool</span>) <span class="punctuation">-&gt;</span> (<span class="type">bool</span>, <span class="type">f32</span>) &#123; (b, a) &#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="title function_ invoke__">swap_i16_u16</span>(<span class="number">3i16</span>, <span class="number">4u16</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">y</span> = <span class="title function_ invoke__">swap_f32_bool</span>(<span class="number">5f32</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="built_in">print!</span>(<span class="string">&quot;&#123;:?&#125; &#123;:?&#125;&quot;</span>, x, y);</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè°ƒç”¨äº†ä¸¤å¤„ï¼Œå°±ç”Ÿæˆäº†ä¸¤ä¸ªå…·ä½“çš„å‡½æ•°ã€‚</p>
<p>ç¬¬å››é˜¶æ®µï¼Œæ˜¯ç¼–è¯‘è¿™äº›ç”Ÿæˆçš„ä»£ç ã€‚</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">swap</span>&lt;T1, T2&gt;(a: T1, b: T2) <span class="punctuation">-&gt;</span> (T2, T1) &#123; (b, a) &#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="title function_ invoke__">swap</span>(<span class="string">&#x27;A&#x27;</span>, <span class="number">4.5</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">y</span> = <span class="title function_ invoke__">swap</span>(<span class="string">&#x27;g&#x27;</span>, -<span class="number">6</span>.);</span><br><span class="line"><span class="built_in">print!</span>(<span class="string">&quot;&#123;:?&#125; &#123;:?&#125;&quot;</span>, x, y);</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè°ƒç”¨çš„å‚æ•°ç±»å‹ä¸€è‡´ï¼Œä»…ä¼šç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬ï¼Œå› ä¸ºæ‰€æœ‰è°ƒç”¨çš„å‚æ•°ç±»å‹éƒ½ç›¸åŒã€‚</p>
<p>ä¸Šé¢ä¼šç”Ÿæˆï¼Œ</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">swap_char_f64</span>(a: <span class="type">char</span>, b: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> (<span class="type">f64</span>, <span class="type">char</span>) &#123; (b, a) &#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="title function_ invoke__">swap_char_f64</span>(<span class="string">&#x27;A&#x27;</span>, <span class="number">4.5</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">y</span> = <span class="title function_ invoke__">swap_char_f64</span>(<span class="string">&#x27;g&#x27;</span>, -<span class="number">6</span>.);</span><br><span class="line"><span class="built_in">print!</span>(<span class="string">&quot;&#123;:?&#125; &#123;:?&#125;&quot;</span>, x, y);</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢å¾—å‡ºï¼Œä¸€æ®µç¨‹åºï¼Œä¼šç”Ÿæˆå‡ ä¸ªå…·ä½“ç‰ˆæœ¬çš„æœºå™¨ä»£ç ï¼š</p>
<ul>
<li>å¯¹äºç¼–è¯‘éæ³›å‹ä»£ç ï¼Œè¿™ç§å¤šé˜¶æ®µç¼–è¯‘ä¼šæœ‰å‡ åˆ†æ…¢ã€‚</li>
<li>ç”Ÿæˆçš„ä»£ç é’ˆå¯¹æ¯ä¸ªç‰¹å®šçš„è°ƒç”¨è¿›è¡Œäº†é«˜åº¦ä¼˜åŒ–ï¼Œå› æ­¤ä¸éœ€è¦å¯¹ç±»å‹è½¬æ¢æˆ–å†³ç­–ï¼Œè¿è¡Œæ—¶çš„æ€§èƒ½éƒ½æ˜¯ä¼˜åŒ–çš„ã€‚</li>
<li>æ¯æ¬¡è°ƒç”¨ä½¿ç”¨ä¸åŒçš„æ•°æ®ç±»å‹æ—¶ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„æœºå™¨ç ã€‚è¿™ä¼šå¯¼è‡´ä¸€ä¸ªç°è±¡ï¼Œâ€œä»£ç è†¨èƒ€(code bloat)â€ï¼Œé¢å¯¹è¿™ä¸ªäº‹å®ï¼Œä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œæœ€å¥½ä¸è¦åœ¨å•ä¸€è¿›ç¨‹ä½¿ç”¨è¿‡å¤šä¸åŒçš„ç±»å‹ï¼Œå…·ä½“ä»£ç ä½¿ç”¨å…·ä½“çš„ç±»å‹ï¼Œè¿™å›ç»™CPUç¼“å­˜å¸¦æ¥è´Ÿæ‹…ã€‚</li>
</ul>
<p>å¯¹äºæ³›å‹ç»“æ„ä½“å’Œæ³›å‹å…ƒç»„-ç»“æ„ä½“ä¹Ÿä¸€æ ·åŸç†ã€‚</p>
<h2 id="Generic-Arrays-and-Vectors"><a class="header-anchor" href="#Generic-Arrays-and-Vectors">Â¶</a>Generic Arrays and Vectors</h2>
<p>å…³äºarrayå’Œvectorä¸æ˜¯æ–°çš„äº‹ç‰©ã€‚æœ€å¼€å§‹çš„ç« èŠ‚å·²ç»ä»‹ç»äº†æ³›å‹ç±»å‹ã€‚</p>
<p>å®é™…ä¸Šï¼Œarrayæ˜¯Rustè¯­è¨€çš„ä¸€éƒ¨åˆ†ï¼Œvectorä½œä¸ºç»“æ„ä½“å®šä¹‰åœ¨Rustæ ‡å‡†åº“ã€‚</p>
<h2 id="Generic-Enums"><a class="header-anchor" href="#Generic-Enums">Â¶</a>Generic Enums</h2>
<p>åœ¨Rustä¸­ï¼Œenumä¹Ÿå¯ä»¥æ³›åŒ–ã€‚</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Result1</span>&lt;SuccessCode, FailureCode&gt; &#123;</span><br><span class="line">	<span class="title function_ invoke__">Success</span>(SuccessCode),</span><br><span class="line">	<span class="title function_ invoke__">Failure</span>(FailureCode, <span class="type">char</span>),</span><br><span class="line">	Uncertainty,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">_res</span> = Result1::Success::&lt;<span class="type">u32</span>,<span class="type">u16</span>&gt;(<span class="number">12u32</span>);</span><br><span class="line">_res = Result1::Uncertainty;</span><br><span class="line">_res = Result1::<span class="title function_ invoke__">Failure</span>(<span class="number">0u16</span>, <span class="string">&#x27;d&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯åˆæ³•çš„ã€‚ä¸‹é¢ä»£ç åœ¨æœ€åä¸€è¡Œå‘ç”Ÿç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå‚æ•°Failureçš„ç±»å‹æ˜¯<code>u32</code>ï¼Œä½†æ ¹æ®åˆå§‹åŒ–ï¼Œå®ƒå®é™…ä¸Šåº”è¯¥æ˜¯<code>u16</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Result1</span>&lt;SuccessCode, FailureCode&gt; &#123;</span><br><span class="line">    <span class="title function_ invoke__">Success</span>(SuccessCode),</span><br><span class="line">    <span class="title function_ invoke__">Failure</span>(FailureCode, <span class="type">char</span>),</span><br><span class="line">    Uncertainty,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">_res</span> = Result1::Success::&lt;<span class="type">u32</span>,<span class="type">u16</span>&gt;(<span class="number">12u32</span>);</span><br><span class="line">_res = Result1::Uncertainty;</span><br><span class="line">_res = Result1::<span class="title function_ invoke__">Failure</span>(<span class="number">0u32</span>, <span class="string">&#x27;d&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>æ³›å‹æšä¸¾åœ¨Rustæ ‡å‡†åº“ä¸­è¢«å¤§é‡ç”¨åˆ°ã€‚</p>
<p>Rustæ ‡å‡†åº“ä¸­enumæœ€å¸¸è¢«ç”¨äºè§£å†³ä¸‹é¢å¸¸è§é—®é¢˜ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°å¯ä»¥å¤±è´¥(<code>fail</code>)ï¼Œå¤±è´¥æ—¶åº”è¯¥åšä»€ä¹ˆï¼Ÿ</p>
<p>ä¾‹å¦‚ï¼Œå½“vectoråŒ…å«æ¡ç›®ï¼Œå‡½æ•°<code>pop</code>ç§»é™¤vectoræœ€åä¸€ä¸ªæ¡ç›®ï¼Œå¹¶è¿”å›è¢«åˆ é™¤çš„è®°å½•ã€‚è‹¥vectoræ˜¯ç©ºçš„ï¼Œè¡¨è¾¾å¼<code>vec![0;0].pop()</code>åº”è¯¥æ€æ ·å¤„ç†ï¼Ÿ</p>
<p>æŸäº›è¯­è¨€ä¸å®šä¹‰è¿™ç§è¡Œä¸ºï¼Œè®©å…¶æŠ¥é”™æˆ–å¯¼è‡´ä¸€ä¸ªä¸å¯é¢„æµ‹çš„ç»“æœã€‚Rustå°½å¯èƒ½é¿å…è¿™ç§æœªå®šä¹‰çš„è¡Œä¸ºã€‚</p>
<p>æŸäº›è¯­è¨€æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œç”±é—­åˆå—æˆ–å½“å‰å‡½æ•°çš„è°ƒç”¨æ–¹å¤„ç†ï¼Œæˆ–æŠ¥é”™è¯¯ã€‚Rustä¸­ä¸é€‚ç”¨å¼‚å¸¸è¿™ä¸€æ¦‚å¿µã€‚</p>
<p>æŸäº›è¯­è¨€ä¼šè¿”å›ä¸€ä¸ªæŒ‡å®šçš„<code>null</code>å€¼ã€‚ä½†vectorå¯ä»¥åŒ…å«å‡ ä¹æ‰€æœ‰ç±»å‹ï¼Œè¿™äº›ç±»å‹æ²¡æœ‰<code>null</code>å€¼ã€‚</p>
<p>ä¸‹é¢æ˜¯Rustçš„è§£å†³åŠæ³•ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>];</span><br><span class="line"><span class="keyword">for</span> <span class="variable">_</span> <span class="keyword">in</span> <span class="number">0</span>..<span class="number">5</span> &#123;</span><br><span class="line">	<span class="keyword">let</span> <span class="variable">item</span>: <span class="type">Option</span>&lt;<span class="type">i32</span>&gt; = v.<span class="title function_ invoke__">pop</span>();</span><br><span class="line">	<span class="keyword">match</span> item &#123;</span><br><span class="line">		<span class="title function_ invoke__">Some</span>(number) =&gt; <span class="built_in">print!</span>(<span class="string">&quot;&#123;&#125;, &quot;</span>, number),</span><br><span class="line">		<span class="literal">None</span> =&gt; <span class="built_in">print!</span>(<span class="string">&quot;#, &quot;</span>),</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»“æœå°†è¾“å‡ºï¼šâ€œ33, 22, 11, #, #, â€ã€‚</p>
<p><code>pop</code>å‡½æ•°ä½œç”¨äº<code>Vec&lt;T&gt;</code>ç±»å‹å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ª<code>Option&lt;T&gt;</code>ç±»å‹çš„å€¼ã€‚</p>
<p>è¯¥æ³›å‹ç±»å‹è¢«å®šä¹‰åœ¨Rustçš„æ ‡å‡†åº“ä¸­ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Option</span>&lt;T&gt; &#123;</span><br><span class="line">	<span class="title function_ invoke__">Some</span>(T),</span><br><span class="line">	<span class="literal">None</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒæ˜¯ä¸€ä¸ªoptionalçš„Tç±»å‹ï¼Œè¡¨ç¤ºæœ‰ï¼Œæˆ–è€…æ— ã€‚</p>
<h2 id="Error-Handling"><a class="header-anchor" href="#Error-Handling">Â¶</a>Error Handling</h2>
<p>Rustæ ‡å‡†åº“ä¹Ÿå®šä¹‰äº†ä¸€ä¸ªæ³›å‹æšä¸¾æ¥å¤„ç†å‡½æ•°ä¸èƒ½è¿”å›æ­£ç¡®ç±»å‹çš„æƒ…å†µï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">divide</span>(numerator: <span class="type">f64</span>, denominator: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>, <span class="type">String</span>&gt; &#123;</span><br><span class="line">	<span class="keyword">if</span> denominator == <span class="number">0</span>. &#123;</span><br><span class="line">		<span class="title function_ invoke__">Err</span>(<span class="built_in">format!</span>(<span class="string">&quot;Divide by zero&quot;</span>))</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="title function_ invoke__">Ok</span>(nmerator / denominator)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print!</span>(<span class="string">&quot;&#123;:?&#125;, &#123;:?&#125;&quot;</span>, <span class="title function_ invoke__">divide</span>(<span class="number">8</span>., <span class="number">2</span>.), <span class="title function_ invoke__">divide</span>(<span class="number">8</span>., <span class="number">0</span>.));</span><br></pre></td></tr></table></figure>
<p>è¿™å›è¾“å‡º <code>Ok(4), Err(&quot;Divide by zero&quot;)</code>ã€‚</p>
<p><code>Result</code>ç±»å‹å’Œ<code>Option</code>ç±»å‹ç±»ä¼¼ï¼Œå…¶ä¸­<code>Option</code>è¡¨ç¤ºæœ‰æˆ–æ— ï¼Œ<code>Result</code>è¡¨è¿°äº†ä¸€ç§å¼‚å¸¸æƒ…å†µã€‚</p>
<p>å®ƒåœ¨æ ‡å‡†åº“çš„å®šä¹‰ä¸ºï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Result</span>&lt;T, E&gt; &#123;</span><br><span class="line">	<span class="title function_ invoke__">Ok</span>(T),</span><br><span class="line">	<span class="title function_ invoke__">Err</span>(E),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä½¿ç”¨äº†debugè¾“å‡ºç»“æœä¿¡æ¯ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸å»ºè®®è¿™æ ·åšï¼Œå¯ä»¥æ”¹ä¸ºä¸‹é¢è¿™ç§å½¢å¼ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">divide</span>(numerator: <span class="type">f64</span>, denominator: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>, <span class="type">String</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> denominator == <span class="number">0</span>. &#123;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(<span class="built_in">format!</span>(<span class="string">&quot;Divide by zero&quot;</span>))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(numerator / denominator)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">show_divide</span>(num: <span class="type">f64</span>, den: <span class="type">f64</span>) &#123;</span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">divide</span>(num, den) &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(val) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; / &#123;&#125; = &#123;&#125;&quot;</span>, num, den, val),</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(msg) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Cannot divide &#123;&#125; by &#123;&#125;: &#123;&#125;&quot;</span>, num, den, msg),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">show_divide</span>(<span class="number">8</span>., <span class="number">2</span>.);</span><br><span class="line"><span class="title function_ invoke__">show_divide</span>(<span class="number">8</span>., <span class="number">0</span>.);</span><br></pre></td></tr></table></figure>
<p>ç»“æœå°†è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">8 / 2 = 4</span><br><span class="line">Cannot divide 8 by 0: Divide by zero</span><br></pre></td></tr></table></figure>
<h2 id="Enum-Standard-Utility-Functions"><a class="header-anchor" href="#Enum-Standard-Utility-Functions">Â¶</a>Enum Standard Utility Functions</h2>
<p><code>Option</code>å’Œ<code>Result</code>æ ‡å‡†æ³›å‹ç±»å‹ä»¥ä¸€ç§çµæ´»ã€é«˜æ•ˆçš„æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬æ•è·real-world codeå‡ºç°çš„æ‰€æœ‰æƒ…å†µï¼›ç„¶è€Œï¼Œä½¿ç”¨<code>match</code>è¯­å¥æ¥è·å–ç»“æœæœ‰ç‚¹ä¸æ–¹ä¾¿ã€‚</p>
<p>å› æ­¤ï¼Œæ ‡å‡†åº“åŒ…å«ä¸€äº›å·¥å…·ç±»å‡½æ•°ï¼Œä»¥æ–¹ä¾¿<code>Option</code>å’Œ<code>Result</code>ç±»å‹çš„ä½¿ç”¨ã€‚</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">divide</span>(numerator: <span class="type">f64</span>, denominator: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>, <span class="type">String</span>&gt; &#123;</span><br><span class="line">	<span class="keyword">if</span> denominator == <span class="number">0</span>. &#123;</span><br><span class="line">		<span class="title function_ invoke__">Err</span>(<span class="built_in">format!</span>(<span class="string">&quot;Divide by zero&quot;</span>))</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="title function_ invoke__">Ok</span>(numerator / denominator)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">r1</span> = <span class="title function_ invoke__">divide</span>(<span class="number">8</span>., <span class="number">2</span>.);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">r2</span> = <span class="title function_ invoke__">divide</span>(<span class="number">8</span>., <span class="number">0</span>.);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>, r1.<span class="title function_ invoke__">is_ok</span>(), r2.<span class="title function_ invoke__">is_ok</span>());</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>, r1.<span class="title function_ invoke__">is_err</span>(), r2.<span class="title function_ invoke__">is_err</span>());</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, r1.<span class="title function_ invoke__">unwrap</span>());</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, r2.<span class="title function_ invoke__">unwrap</span>());</span><br></pre></td></tr></table></figure>
<p>ç¨‹åºé¦–å…ˆè¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">true false</span><br><span class="line">false true</span><br><span class="line">4</span><br></pre></td></tr></table></figure>
<p>ç„¶åç»™å‡ºä¸€ä¸ªpanicä¿¡æ¯ï¼šâ€œthread â€˜mainâ€™ panicked at â€˜called <code>Result::unwrap()</code> on an <code>Err</code> value: â€œDivide by zeroâ€â€™â€ã€‚</p>
<p><code>is_ok</code>å‡½æ•°è¿”å›<code>true</code>å¦‚æœå˜å¼ä¸ºOkï¼Œ<code>is_err</code>è¿”å›<code>true</code>å¦‚æœå˜å¼ä¸ºErrã€‚<code>is_err()</code>ç­‰ä»·äº<code>! is_ok()</code>ã€‚</p>
<p>å½“ä½œç”¨äºä¸€ä¸ªOkå˜å¼ï¼Œ<code>unwrap</code>å‡½æ•°è¿”å›<code>Ok</code>å˜å¼çš„å€¼ï¼Œå¦åˆ™å‡ºç°panicsã€‚è¯¥å‡½æ•°çš„æ„æ€æ˜¯â€œæˆ‘çŸ¥é“åœ¨ä¸€ä¸ªOkå˜å¼ä¸­å¯ä»¥wrapè¿™ä¸ªå€¼ï¼Œå› æ­¤æˆ‘åªæƒ³è·å–è¿™ä¸ªå®¹å™¨çš„å€¼ï¼Œæ‘ˆé™¤å®ƒçš„è½¬æ¢ï¼›è‹¥ä¸æ˜¯Okå˜å¼ï¼Œä¼šå‡ºç°ä¸€ä¸ªä¸å¯è¦†ç›–çš„é”™è¯¯ï¼Œå› æ­¤æˆ‘ä¼šç«‹å³ç»ˆæ­¢è¯¥ç¨‹åºâ€ã€‚è¯¥ä»£ç ç¼–è¯‘æ²¡æœ‰å‡ºé”™ï¼Œè¿è¡Œæ—¶ä¼šå‡ºç°panicé”™è¯¯ã€‚</p>
<p>å¯¹äº<code>Option</code>æšä¸¾ä¹Ÿæœ‰<code>unwrap</code>å‡½æ•°ï¼Œè¦è¾“å‡ºä¸€ä¸ªVecçš„æ‰€æœ‰åˆ¶ï¼Œä½ å¯ä»¥ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>];</span><br><span class="line"><span class="keyword">for</span> <span class="variable">_</span> <span class="keyword">in</span> <span class="number">0</span>..v.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">	<span class="built_in">print!</span>(<span class="string">&quot;&#123;&#125;, &quot;</span>, v.<span class="title function_ invoke__">pop</span>().<span class="title function_ invoke__">unwrap</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»“æœä¼šè¾“å‡ºï¼šâ€œ33, 22, 11,â€ã€‚<code>unwrap</code>çš„è°ƒç”¨ä¼šè·å–<code>Ok</code>å†…éƒ¨çš„å€¼ã€‚æˆ‘ä»¬é¿å…äº†åœ¨ä¸€ä¸ªç©ºvectorè°ƒç”¨<code>pop()</code>ï¼›å¦åˆ™ï¼Œ<code>pop()</code>è¿”å›ä¸€ä¸ª<code>None</code>ï¼Œ<code>unwrap()</code>ä¼šå‡ºç°panickã€‚</p>
<p><code>unwrap</code>å‡½æ•°å¸¸è¢«ç”¨äº<code>quick-and-dirty</code>Rustç¨‹åºä¸­ï¼Œå³é”™è¯¯ä¸è¦æ±‚å¤„ç†çš„æƒ…å†µã€‚</p>
</div></article><nav class="article-nav"><div class="article-nav-prev">ğŸ”™<a href="/2023/01/11/rust/beginning/chapter11_Allocating%20Memory/">ruståŸºç¡€å…¥é—¨[11] - Allocating Memory</a></div><div class="article-nav-next">ğŸ”œ<a href="/2023/01/09/rust/beginning/chapter09_Defining%20Functions/">ruståŸºç¡€å…¥é—¨[09] - Defining Functions</a></div></nav><div id="base-discus"><div id="disqus_thread"></div><script>var disqus_shortname = 'barudisshu-github-io';
var disqus_identifier = '2023/01/10/rust/beginning/chapter10_Defining Generic Functions and Structs/';
var disqus_title = 'ruståŸºç¡€å…¥é—¨[10] - Defining Generic Functions and Structs';
var disqus_url = 'https://galudisu.info/2023/01/10/rust/beginning/chapter10_Defining Generic Functions and Structs/';
(function () {
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async>  </script></div></div></div><footer class="base-footer"><div class="footer-wrapper"><span>Â©2016 - 2025 <a href="https://galudisu.info">barudisshu</a>, unless otherwise noted.</span></div></footer><div class="dom-ready">
<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>

<link rel="stylesheet" href="//cdn.bootcss.com/pace/1.0.2/themes/green/pace-theme-flash.min.css">

<script src="/js/base.js"></script>

<script src="/js/rabbit-lyrics.js"></script>
</div></body></html>