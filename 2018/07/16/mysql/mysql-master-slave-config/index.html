<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><title>实践MySQL主从复制(Master-Slave)的操作流程！</title>
<link rel="stylesheet" href="/css/layout.css">
<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="/css/vendors/rabbit-lyrics.css">
<link rel="shortcut icon" href="/img/favicon.ico"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="简单易懂の现代魔法" type="application/atom+xml">
</head><body><header class="base-menu"><div class="menu-wrapper"><div class="menu-layout-bg"></div><nav class="menu-content"><ul class="menu-list"><li class="menu-item"><a class="menu-link" href="/">简单易懂の现代魔法</a></li><li class="menu-item"><a class="menu-link" href="/archives/">Archives</a></li><li class="menu-item"><a class="menu-link" target="_blank" rel="noopener" href="http://weibo.com/u/2360401155">Weibo</a></li><li class="menu-item"><a class="menu-link" href="/about">About</a></li><li class="menu-item"><a class="menu-link" href="/atom.xml">Rss</a></li></ul></nav></div></header><header class="base-mobile-menu"><div class="mobile-menu-wrapper"><div class="menu-layout-bg"></div><nav class="menu-content"><ul class="menu-list"><li class="menu-item"><a class="menu-link" href="/">简单易懂の现代魔法</a></li><li class="menu-item"><a class="menu-link" href="/archives/">Archives</a></li><li class="menu-item"><a class="menu-link" target="_blank" rel="noopener" href="http://weibo.com/u/2360401155">Weibo</a></li><li class="menu-item"><a class="menu-link" href="/about">About</a></li><li class="menu-item"><a class="menu-link" href="/atom.xml">Rss</a></li></ul></nav><div class="toggle-menu" id="mobile-menu-toggle"><span class="menu-bar"></span><span class="menu-bar"> </span><span class="menu-bar"></span></div></div></header><div class="base-content"><div class="base-content-main"><article class="article-main"><h1 class="article-title">实践MySQL主从复制(Master-Slave)的操作流程！</h1><div class="article-meta"><p class="meta-item meta-time"><span class="meta-item-title"></span><i class="icon-calendar"> </i>2018-07-16</p><p class="meta-item meta-tag"><span class="meta-item-title"></span><i class="icon-tags"> </i><a class="tag-link" href="/tags/mysql/">mysql<span class="tag">, </span></a><a class="tag-link" href="/tags/lvs/">lvs</a></p></div><div class="article-content"><p>对于发展很小的公司来说，单台服务器支撑整个公司的运转是常见的事情。但是随着用户量的增加，随之而来的数据量也会跟着增加，这就导致更多地用户会使用查询select我们的数据库，从而导致性能急剧的下降。例如，查询缓慢，用户等待时间长等等，高并发，大数据，负载均衡甚至是集群，这些方案都是小公司不会采用的，一方面成本极高，需要运维维护，这已经抵n个程序猿的工资了，所以一般不会采用这种模式。</p>
<p>仔细的分析一下，这种情况，其实更多地是来源于数据库mysql的承受能力变大，一方面需要读操作，另一方面有需要增删改操作，那么多人同时请求肯定受不了啦！<br>
有人说使用缓存，但是再想想mysql的缓存是有限制的，并不是一味的去缓存就可以，又有人说使用redis缓存，存储在内存中，然而事实上运转的时候redis缓存并不能全部给你缓存，有些数据需要实时的查看，而且redis缓存过多，导致cpu直接上涨，严重的话，机器直接运转停止。</p>
<span id="more"></span>
<h2 id="mysql主从复制的解析描述"><a class="header-anchor" href="#mysql主从复制的解析描述">¶</a>mysql主从复制的解析描述</h2>
<p>主从复制是指一台服务器充当主数据库服务器（master），另一台或多台服务器充当从数据库服务器（slave），主服务器中的数据自动复制到从服务器之中。对于多级复制，数据库服务器即可充当主机，也可充当从机。MySQL主从复制的基础是主服务器对数据库修改记录二进制日志，从服务器通过主服务器的二进制日志自动执行更新。<br>
请注意：当你进行复制时，所有对复制中的表的更新必须在主服务器上进行。否则，你必须要小心，以避免用户对主服务器上的表进行的更新与对从服务器上的表所进行的更新之间的冲突。</p>
<p>首先准备环境：<br>
1 两台服务器（这里还是以虚拟机做）</p>
<ul>
<li>主服务器IP：192.168.200.139</li>
<li>从服务器IP：192.168.153.140<br>
安装的mysql（安装过程不在叙述）：版本号尽可能的保持一致性 本机安装版本是：mysql5.7.21</li>
</ul>
<p>一、修改主服务器的mysql配置文件</p>
<ol>
<li>本机的主服务器mysql配置文件地址在：<code>etc/my.cnf</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">开启二进制日志</span></span><br><span class="line">log-bin=master-bin</span><br><span class="line">log-bin-index=master-bin.index</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置server-id</span></span><br><span class="line">server-id=1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">关闭名称解析</span></span><br><span class="line">skip-name-resolve</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>创建从服务器登录主服务器的账号</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mysqld</span><br><span class="line"></span><br><span class="line">mysql -uroot -p</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建用户</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">create user <span class="string">&#x27;galudisu&#x27;</span>@<span class="string">&#x27;192.168.200.%&#x27;</span> identified by <span class="string">&#x27;password&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">分配权限</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">grant replication slave on *.* to <span class="string">&#x27;galudisu&#x27;</span>@<span class="string">&#x27;192.168.200.%&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">刷新权限</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">flush privileges;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>查看主服务器(master)二进制日志状态</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show master status;</span></span><br><span class="line">+-------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">| File              | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+-------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">| master-bin.000001 |      567 |              |                  |                   |</span><br><span class="line">+-------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt;</span></span><br></pre></td></tr></table></figure>
<p>解析下参数：<br>
<i class="conum" data-value="1"></i> File-&gt;mysql-bin.000001 表示记录二进制文件名称<br>
<i class="conum" data-value="2"></i> Position-&gt;948 所在位置<br>
<i class="conum" data-value="3"></i> Binlog_Do_DB 指定mysql的binlog日志记录哪个db<br>
<i class="conum" data-value="4"></i> Binlog_Ignore_DB 告诉master，如果当前的数据库是db_name（就是Binlog_Ignore_DB这个对应的值），不应将更新保存到二进制日志中<br>
<i class="conum" data-value="5"></i> Executed_Gtid_Set mysql5.7以上新增参数 具体用法 自行百度下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">不同步哪些数据库</span></span><br><span class="line">binlog-ignore-db=mysql</span><br><span class="line">binlog-ignore-db=test</span><br><span class="line">binlog-ignore-db=information_schema</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">只同步哪些数据库，除此之外，其它不同步</span></span><br><span class="line">binlog-do-db=shop</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>查看二进制日志状态</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show binlog events \G</span></span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">   Log_name: master-bin.000001</span><br><span class="line">        Pos: 4</span><br><span class="line"> Event_type: Format_desc</span><br><span class="line">  Server_id: 1</span><br><span class="line">End_log_pos: 123</span><br><span class="line">       Info: Server ver: 5.7.22-log, Binlog ver: 4</span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">   Log_name: master-bin.000001</span><br><span class="line">        Pos: 123</span><br><span class="line"> Event_type: Previous_gtids</span><br><span class="line">  Server_id: 1</span><br><span class="line">End_log_pos: 154</span><br><span class="line">       Info: </span><br><span class="line">*************************** 3. row ***************************</span><br><span class="line">   Log_name: master-bin.000001</span><br><span class="line">        Pos: 154</span><br><span class="line"> Event_type: Anonymous_Gtid</span><br><span class="line">  Server_id: 1</span><br><span class="line">End_log_pos: 219</span><br><span class="line">       Info: SET @@SESSION.GTID_NEXT= &#x27;ANONYMOUS&#x27;</span><br><span class="line">*************************** 4. row ***************************</span><br><span class="line">   Log_name: master-bin.000001</span><br><span class="line">        Pos: 219</span><br><span class="line"> Event_type: Query</span><br><span class="line">  Server_id: 1</span><br><span class="line">End_log_pos: 415</span><br><span class="line">       Info: CREATE USER &#x27;galudisu&#x27;@&#x27;192.168.200.%&#x27; IDENTIFIED WITH &#x27;mysql_native_password&#x27; AS &#x27;*6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9&#x27;</span><br><span class="line">*************************** 5. row ***************************</span><br><span class="line">   Log_name: master-bin.000001</span><br><span class="line">        Pos: 415</span><br><span class="line"> Event_type: Anonymous_Gtid</span><br><span class="line">  Server_id: 1</span><br><span class="line">End_log_pos: 480</span><br><span class="line">       Info: SET @@SESSION.GTID_NEXT= &#x27;ANONYMOUS&#x27;</span><br><span class="line">*************************** 6. row ***************************</span><br><span class="line">   Log_name: master-bin.000001</span><br><span class="line">        Pos: 480</span><br><span class="line"> Event_type: Query</span><br><span class="line">  Server_id: 1</span><br><span class="line">End_log_pos: 567</span><br><span class="line">       Info: flush privileges</span><br><span class="line">6 rows in set (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt;</span></span><br></pre></td></tr></table></figure>
<p>二、配置从服务器（slave）</p>
<ol>
<li>同样的配置文件路径 <code>etc/my.cnf</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置server-id，让从服务器又唯一ID号</span></span><br><span class="line">server-id=5</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">打开MySQL日志，日志格式为二进制</span></span><br><span class="line">relay_log=relay-bin</span><br><span class="line">relay_log_index=relay-bin.index</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置制度权限</span></span><br><span class="line">read_only=1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">开启从服务器二进制日志</span></span><br><span class="line">log_bin=slave-bin</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使得更新的数据写入二进制日志中</span></span><br><span class="line">log_slave_updates=1</span><br></pre></td></tr></table></figure>
<p>PS：上面未打开选项是配置文件中可能需要用到的参数，目前只做演示主从 所以是需要使用server-id=5 这个参数就行了。</p>
<ol start="2">
<li>启动从服务器复制线程机制<br>
进入从服务器的数据库中：</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">msyql -uroot -p**</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">change master to</span></span><br><span class="line"><span class="meta prompt_">	-&gt; </span><span class="language-bash">master_host=<span class="string">&#x27;192.168.200.139&#x27;</span>, <span class="comment"># 主服务器ip地址</span></span></span><br><span class="line"><span class="meta prompt_">	-&gt; </span><span class="language-bash">master_user=<span class="string">&#x27;galudisu&#x27;</span>, <span class="comment"># 主服务器创建的授权用户(切记这个是给从服务器登录的账号)</span></span></span><br><span class="line"><span class="meta prompt_">	-&gt; </span><span class="language-bash">master_password=<span class="string">&#x27;123456&#x27;</span>, <span class="comment"># 主服务器创建用户的密码</span></span></span><br><span class="line"><span class="meta prompt_">	-&gt; </span><span class="language-bash">master_log_file=<span class="string">&#x27;mysql-bin.000001&#x27;</span>, <span class="comment"># 主服务器的二进制文件名称</span></span></span><br><span class="line"><span class="meta prompt_">	-&gt; </span><span class="language-bash">master_log_pos=567; <span class="comment"># 开始记录的位置</span></span></span><br><span class="line">回车出现：</span><br><span class="line">Query OK, 0 rows affected, 2 warnings(0.03 sec)</span><br></pre></td></tr></table></figure>
<p>PS：上面的sql语句是从头开始复制第一个binlog，如果想从某个位置开始复制binlog，就需要在change master to时指定要开始的binlog文件名和语句在文件中的起点位置，参数为：master_log_file和master_log_pos这两个参数哦。</p>
<ol start="3">
<li>启动slave同步进程：</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">start slave;</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>查看状态是否已启动复制功能</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show slave status\G;</span></span><br><span class="line"></span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: 192.168.200.139</span><br><span class="line">                  Master_User: galudisu</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 60</span><br><span class="line">              Master_Log_File: master-bin.000001</span><br><span class="line">          Read_Master_Log_Pos: 931</span><br><span class="line">               Relay_Log_File: relay-bin.000004</span><br><span class="line">                Relay_Log_Pos: 321</span><br><span class="line">        Relay_Master_Log_File: master-bin.000001</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB: </span><br><span class="line">          Replicate_Ignore_DB: </span><br><span class="line">           Replicate_Do_Table: </span><br><span class="line">       Replicate_Ignore_Table: </span><br><span class="line">      Replicate_Wild_Do_Table: </span><br><span class="line">  Replicate_Wild_Ignore_Table: </span><br><span class="line">                   Last_Errno: 0</span><br><span class="line">                   Last_Error: </span><br><span class="line">                 Skip_Counter: 0</span><br><span class="line">          Exec_Master_Log_Pos: 931</span><br><span class="line">              Relay_Log_Space: 522</span><br><span class="line">              Until_Condition: None</span><br><span class="line">               Until_Log_File: </span><br><span class="line">                Until_Log_Pos: 0</span><br><span class="line">           Master_SSL_Allowed: No</span><br><span class="line">           Master_SSL_CA_File: </span><br><span class="line">           Master_SSL_CA_Path: </span><br><span class="line">              Master_SSL_Cert: </span><br><span class="line">            Master_SSL_Cipher: </span><br><span class="line">               Master_SSL_Key: </span><br><span class="line">        Seconds_Behind_Master: 0</span><br><span class="line">Master_SSL_Verify_Server_Cert: No</span><br><span class="line">                Last_IO_Errno: 0</span><br><span class="line">                Last_IO_Error: </span><br><span class="line">               Last_SQL_Errno: 0</span><br><span class="line">               Last_SQL_Error: </span><br><span class="line">  Replicate_Ignore_Server_Ids: </span><br><span class="line">             Master_Server_Id: 1</span><br><span class="line">                  Master_UUID: 14739182-88be-11e8-ba6a-000c292e5d5b</span><br><span class="line">             Master_Info_File: /var/lib/mysql/master.info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">                  Master_Bind: </span><br><span class="line">      Last_IO_Error_Timestamp: </span><br><span class="line">     Last_SQL_Error_Timestamp: </span><br><span class="line">               Master_SSL_Crl: </span><br><span class="line">           Master_SSL_Crlpath: </span><br><span class="line">           Retrieved_Gtid_Set: </span><br><span class="line">            Executed_Gtid_Set: </span><br><span class="line">                Auto_Position: 0</span><br><span class="line">         Replicate_Rewrite_DB: </span><br><span class="line">                 Channel_Name: </span><br><span class="line">           Master_TLS_Version: </span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: </span><br><span class="line">No query specified</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>Slave_IO_Running: Yes</code><br>
<code>Slave_SQL_Running: Yes</code></p>
<p>这两项必须为Yes才是成功,截图出现问题 没有截图（抱歉）。</p>
<p>如果使用了复制的虚拟机, mysql服务的uuid可能会一样Slave_IO_Runing=No, 需要把从服务器mysql目录下的auto.cnf删掉然后重启mysql服务。<br>
例如我从服务器的mysql地址是：/var/lib/mysql 切换到下面删除auto.cnf即可：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf auto.cnf</span><br></pre></td></tr></table></figure>
<p>另外，如果有防火墙，需要添加3306端口到iptables。</p>
<p>三、测试一下喽</p>
<p>在主服务器(master)上，进入数据库：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show databases;</span></span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows in set (0.11 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">create database shop;</span></span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt;</span></span><br></pre></td></tr></table></figure>
<p>在从服务器(slave)上，看看是否有相应的数据库：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show databases;</span></span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| shop               |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows in set (0.12 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt;</span></span><br></pre></td></tr></table></figure>
<p>这个时候从库就出现这条数据了。</p>
<p>好了到这里基本上已经OK了，如果有细节未处理，大家就可以自行补充。</p>
</div></article><nav class="article-nav"><div class="article-nav-prev">🔙<a href="/2018/07/24/algorithm/ga/genetic-algorithm/">基于遗传算法实现排课系统</a></div><div class="article-nav-next">🔜<a href="/2018/07/12/slick/slick3-with-code-generator/">Slick 3 代码生成实战</a></div></nav><div id="base-discus"><div id="disqus_thread"></div><script>var disqus_shortname = 'barudisshu-github-io';
var disqus_identifier = '2018/07/16/mysql/mysql-master-slave-config/';
var disqus_title = '实践MySQL主从复制(Master-Slave)的操作流程！';
var disqus_url = 'https://galudisu.info/2018/07/16/mysql/mysql-master-slave-config/';
(function () {
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async>  </script></div></div></div><footer class="base-footer"><div class="footer-wrapper"><span>©2016 - 2025 <a href="https://galudisu.info">barudisshu</a>, unless otherwise noted.</span></div></footer><div class="dom-ready">
<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>

<link rel="stylesheet" href="//cdn.bootcss.com/pace/1.0.2/themes/green/pace-theme-flash.min.css">

<script src="/js/base.js"></script>

<script src="/js/rabbit-lyrics.js"></script>
</div></body></html>