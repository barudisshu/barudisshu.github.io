<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><title>åŸºäºé—ä¼ ç®—æ³•å®ç°æ’è¯¾ç³»ç»Ÿ</title>
<link rel="stylesheet" href="/css/layout.css">
<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="/css/vendors/rabbit-lyrics.css">
<link rel="shortcut icon" href="/img/favicon.ico"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•" type="application/atom+xml">
</head><body><header class="base-menu"><div class="menu-wrapper"><div class="menu-layout-bg"></div><nav class="menu-content"><ul class="menu-list"><li class="menu-item"><a class="menu-link" href="/">ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•</a></li><li class="menu-item"><a class="menu-link" href="/archives/">Archives</a></li><li class="menu-item"><a class="menu-link" target="_blank" rel="noopener" href="http://weibo.com/u/2360401155">Weibo</a></li><li class="menu-item"><a class="menu-link" href="/about">About</a></li><li class="menu-item"><a class="menu-link" href="/atom.xml">Rss</a></li></ul></nav></div></header><header class="base-mobile-menu"><div class="mobile-menu-wrapper"><div class="menu-layout-bg"></div><nav class="menu-content"><ul class="menu-list"><li class="menu-item"><a class="menu-link" href="/">ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•</a></li><li class="menu-item"><a class="menu-link" href="/archives/">Archives</a></li><li class="menu-item"><a class="menu-link" target="_blank" rel="noopener" href="http://weibo.com/u/2360401155">Weibo</a></li><li class="menu-item"><a class="menu-link" href="/about">About</a></li><li class="menu-item"><a class="menu-link" href="/atom.xml">Rss</a></li></ul></nav><div class="toggle-menu" id="mobile-menu-toggle"><span class="menu-bar"></span><span class="menu-bar"> </span><span class="menu-bar"></span></div></div></header><div class="base-content"><div class="base-content-main"><article class="article-main"><h1 class="article-title">åŸºäºé—ä¼ ç®—æ³•å®ç°æ’è¯¾ç³»ç»Ÿ</h1><div class="article-meta"><p class="meta-item meta-time"><span class="meta-item-title"></span><i class="icon-calendar"> </i>2018-07-24</p><p class="meta-item meta-tag"><span class="meta-item-title"></span><i class="icon-tag"> </i><a class="tag-link" href="/tags/ga-ml-scala/">ga, ml, scala</a></p></div><div class="article-content"><p>é—ä¼ ç®—æ³•å±äºNPå®Œå¤‡é—®é¢˜ï¼Œä¸ç¡®å®šé—®é¢˜éœ€è¦å¤§é‡ç¦»æ•£çš„æ•°æ®è¿›è¡Œçº¿æ€§å¤„ç†ã€‚</p>
<span id="more"></span>

<div style="float:left">
<img src="/img/algorithm/ga/DNA-helix.jpg" alt="DNA">
</div>
<div style="float:right">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=489694&auto=1&height=66"></iframe></div>
<div class="clearfix"></div>


<p><code>é—ä¼ ç®—æ³•(genetic algorithm)</code>æ˜¯å—Charles Darwinè‡ªç„¶è¿›åŒ–ç†è®ºå¯å‘çš„æœç´¢å¯å‘å¼ç®—æ³•ã€‚è¯¥ç®—æ³•åæ˜ äº†è‡ªç„¶é€‰æ‹©çš„è¿‡ç¨‹ï¼Œé€‰æ‹©æœ€åˆé€‚çš„ä¸ªä½“è¿›è¡Œç¹æ®–ï¼Œä»¥äº§ç”Ÿä¸‹ä¸€ä»£åä»£ã€‚</p>
<p><img src="/img/algorithm/ga/1_BYDJpa6M2rzWNSurvspf8Q.png" alt="DNA"></p>
<h2 id="Notion-of-Natural-Selection"><a class="header-anchor" href="#Notion-of-Natural-Selection">Â¶</a>Notion of Natural Selection</h2>
<p>è‡ªç„¶é€‰æ‹©çš„è¿‡ç¨‹ï¼Œå¼€å§‹äºç§ç¾¤ä¸­æœ€é€‚ä¸ªä½“çš„é€‰æ‹©ã€‚å®ƒä»¬äº§ç”Ÿå­ä»£ï¼Œå­ä»£ç»§æ‰¿çˆ¶ä»£çš„ç‰¹æ€§ã€‚å¦‚æœçˆ¶ä»£æœ‰æœ€é€‚å€¼ï¼Œå­ä»£å°†æœ‰æ¯”çˆ¶ä»£æ›´å¥½æœºä¼šç”Ÿå­˜ã€‚è¯¥é€‰æ‹©è¿‡ç¨‹å°†è¿­ä»£è¿›è¡Œï¼Œç›´åˆ°æœ€é€‚å€¼ç§ç¾¤ä¸ªä½“å‡ºç°ã€‚</p>
<p>åˆ†æè¯¥é—®é¢˜ï¼Œå¯ä»¥ä»DDDæ–¹é¢æè¿°ï¼Œä»ç§ç¾¤è¿›åŒ–å’Œä¼˜èƒœåŠ£æ±°æ–¹é¢ï¼Œæˆ‘ä»¬éœ€è¦ä¸“ä¸šæœ¯è¯­è¿›è¡Œæè¿°ã€‚æˆ‘ä»¬è€ƒè™‘é—ä¼ è¿›åŒ–æ˜¯å¤šä¸ªè§£å†³æ–¹æ¡ˆå¯¹ä¸€ä¸ªæŠ½è±¡é—®é¢˜çš„æè¿°ã€‚</p>
<p>é—ä¼ ç®—æ³•è€ƒè™‘5ä¸ªé˜¶æ®µ</p>
<ol>
<li>åˆå§‹åŒ–ç§ç¾¤(population)</li>
<li>é€‚å€¼å‡½æ•°(fitness)</li>
<li>è’™ç‰¹å¡ç½—é€‰ä¸¾(selection)</li>
<li>äº¤å‰(crossover)</li>
<li>å˜å¼‚(mutate)</li>
</ol>
<h2 id="Initial-Population"><a class="header-anchor" href="#Initial-Population">Â¶</a>Initial Population</h2>
<p>ä¸€ä¸ªä¸ªä½“(Individual)æ˜¯ä¸€ç³»åˆ—<strong>åŸºå› </strong> çš„é›†åˆï¼ŒåŸºå› ç»„æˆæŸ“è‰²ä½“(<code>Chromosome</code>)çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>åœ¨é—ä¼ ç®—æ³•ä¸­ï¼Œä¸€ç³»åˆ—åŸºå› ç”¨å­—ç¬¦(char)è¡¨ç¤ºï¼Œæœ¯è¯­ç§°ä¸º<code>alphabet</code>ï¼Œå­—æ¯è¡¨æˆ–åŸºå› æ± ã€‚é€šå¸¸ç”¨äºŒè¿›åˆ¶è¡¨ç¤º(1æˆ–0)ã€‚å¦‚ä¸‹çœ‹åˆ°çš„æŸ“è‰²ä½“åŸºå› ç¼–ç ï¼š</p>
<p><img src="/img/algorithm/ga/1_vIrsxg12DSltpdWoO561yA.png" alt="1_vIrsxg12DSltpdWoO561yA.png"></p>
<h2 id="Fitness-Function"><a class="header-anchor" href="#Fitness-Function">Â¶</a>Fitness Function</h2>
<p>é€‚å€¼å‡½æ•°å†³å®šäº†ä¸€ä¸ªä¸ªä½“çš„é€‚åº”èƒ½åŠ›(ä¸€ä¸ªä¸ªä½“ä¸å…¶å®ƒä¸ªä½“çš„ç«äº‰èƒ½åŠ›)ã€‚æ¯ä¸ªä¸ªä½“éƒ½æ‹¥æœ‰è‡ªèº«çš„<code>é€‚å€¼åˆ†æ•°(fitness score)</code>ã€‚ä¸ªä½“è¢«é€‰ä¸­ä½œä¸ºç¹è¡åŸºäºå®ƒè‡ªèº«çš„<code>é€‚å€¼åˆ†æ•°</code>ã€‚</p>
<h2 id="Selection"><a class="header-anchor" href="#Selection">Â¶</a>Selection</h2>
<p>é€‰æ‹©é˜¶æ®µå°±æ˜¯é€‰æ‹©æœ€é€‚ä¸ªä½“ï¼Œå¹¶å°†å®ƒä»¬çš„åŸºå› ä¼ é€’ç»™ä¸‹ä¸€ä»£ã€‚</p>
<p>æ ¹æ®å®ƒä»¬çš„é€‚å€¼åˆ†æ•°(fitness score)é€‰æ‹©ä¸€å¯¹ä¸ªä½“(çˆ¶ä»£)ã€‚é€‚å€¼æ•°é«˜çš„ï¼Œå°†æœ‰æ›´é«˜çš„æœºä¼šè¢«é€‰æ‹©è¿›è¡Œç¹è¡ã€‚</p>
<h2 id="Crossover"><a class="header-anchor" href="#Crossover">Â¶</a>Crossover</h2>
<p>äº¤å‰åœ¨é—ä¼ ç®—æ³•ä¸­æ˜¯æœ€æœ‰æˆæ•ˆçš„é˜¶æ®µã€‚å¯¹äºæ¯ä¸€å¯¹è¢«åŒ¹é…åˆ°çš„çˆ¶ä»£ï¼Œäº¤å‰ç‚¹(crossover point)åœ¨åŸºå› ä¸­è¢«éšæœºé€‰å–ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä»ç¬¬3ä¸ªä½ç½®å¼€å§‹ï¼š</p>
<p><img src="/img/algorithm/ga/1_Wi6ou9jyMHdxrF2dgczz7g.png" alt="1_Wi6ou9jyMHdxrF2dgczz7g.png"></p>
<p>å­ä»£çš„åˆ›å»ºï¼Œæ¥æºäºçˆ¶ä»£åŸºå› çš„äº¤æ¢</p>
<p><img src="/img/algorithm/ga/1_eQxFezBtdfdLxHsvSvBNGQ.png" alt="1_eQxFezBtdfdLxHsvSvBNGQ.png"></p>
<p>æ–°ç”Ÿå­ä»£è¢«æ·»åŠ åˆ°ç§ç¾¤ä¸­ã€‚å­ä»£çš„äº§ç”Ÿï¼Œéƒ½æ˜¯æŒ‰ç…§æ‰¹æ¬¡å‡ºç°ï¼Œä¸ä¼šå‡ºç°å¹´é¾„çš„æ¦‚å¿µï¼Œä¹Ÿä¸è€ƒè™‘ç§ç¾¤æ•°é‡å¢å¤šçš„æƒ…å†µã€‚</p>
<h2 id="Mutation"><a class="header-anchor" href="#Mutation">Â¶</a>Mutation</h2>
<p>åœ¨æŸäº›æ–°ç”Ÿä»£ä¸­ï¼Œå®ƒä»¬æŸäº›åŸºå› å¯èƒ½ä»¥ä¸€ç§éå¸¸ä½çš„æ¦‚ç‡å‘ç”Ÿ<code>å˜å¼‚(mutation)</code>ã€‚è¿™æ„å‘³ç€æ–°ç”Ÿä»£çš„åŸºå› å¯èƒ½ä¼šå‡ºç°<code>åè½¬(flipped)</code>ã€‚</p>
<p><img src="/img/algorithm/ga/1_CGt_UhRqCjIDb7dqycmOAg.png" alt="1_CGt_UhRqCjIDb7dqycmOAg.png"></p>
<p>åŸºå› çªå˜æ˜¯ä¸ºäº†ä¿æŒç§ç¾¤å†…çš„å¤šæ ·æ€§å’Œé˜²æ­¢è¿‡æ—©æ”¶æ•›ã€‚ä¸€èˆ¬æœ‰ä¸¤ç§æƒ…å†µè€ƒè™‘åŸºå› çªå˜çš„æƒ…å†µï¼š</p>
<ol>
<li>å½“ç§ç¾¤è¿›åŒ–åˆ°ä¸€å®šé˜¶æ®µå‡ºç°æ— è§£(ç§ç¾¤æ‰€æœ‰ä¸ªä½“åŸºå› å…¨éƒ¨ç›¸åŒï¼Œäº¤å‰åå­ä»£åŸºå› å’Œçˆ¶ä»£åŸºå› æ²¡æœ‰å˜åŒ–ï¼›ä½†æ˜¯æ‰€æœ‰ä¸ªä½“éƒ½ä¸æ»¡è¶³æ¡ä»¶ï¼Œç§ç¾¤æ— æ³•å†æ¬¡è¿›åŒ–)</li>
<li>è¿‡æ—©æ”¶æ•›ï¼Œå¾—ä¸åˆ°ä¸€ä¸ªæœ€ä¼˜è§£ã€‚ç‰¹åˆ«æ˜¯å¤šä¸ªç»´åº¦ä¸­ï¼Œæ”¶æ•›å‡ºç°åå‘æŸä¸€ä¸ªç»´åº¦ã€‚</li>
</ol>
<h2 id="Termination"><a class="header-anchor" href="#Termination">Â¶</a>Termination</h2>
<p>ç»ˆæ­¢æ¡ä»¶æ˜¯ç§ç¾¤æ”¶æ•›(æ–°ç”Ÿå­ä»£å’Œå‰ä¸€ä»£æ²¡æœ‰æ˜æ˜¾ä¸åŒ)ã€‚è¿™è¡¨ç¤ºé—ä¼ ç®—æ³•å¾—å‡ºçš„è§£å·²ç»æ»¡è¶³æˆ‘ä»¬çš„é—®é¢˜ã€‚</p>
<h2 id="Psuedocode"><a class="header-anchor" href="#Psuedocode">Â¶</a>Psuedocode</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">START</span><br><span class="line">Generate the initial population</span><br><span class="line">Compute fitness</span><br><span class="line">REPEAT</span><br><span class="line">    Selection</span><br><span class="line">    Crossover</span><br><span class="line">    Mutation</span><br><span class="line">    Compute fitness</span><br><span class="line">UNTIL population has converged</span><br><span class="line">STOP</span><br></pre></td></tr></table></figure>
<h2 id="GA"><a class="header-anchor" href="#GA">Â¶</a>GA</h2>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.typesafe.scalalogging.<span class="type">LazyLogging</span></span><br><span class="line"><span class="keyword">import</span> org.slf4j.<span class="type">Logger</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> scala.annotation.tailrec</span><br><span class="line"><span class="keyword">import</span> scala.collection.immutable.<span class="type">Stream</span>.consWrapper</span><br><span class="line"><span class="keyword">import</span> scala.language._</span><br><span class="line"><span class="keyword">import</span> scala.util.<span class="type">Random</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">GeneticLayout</span> <span class="keyword">extends</span> <span class="title">App</span> <span class="keyword">with</span> <span class="title">LazyLogging</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ç›®æ ‡</span></span><br><span class="line">  <span class="keyword">val</span> target = <span class="string">&quot;101010&quot;</span></span><br><span class="line">  <span class="comment">// åŸºå› æ± </span></span><br><span class="line">  <span class="keyword">val</span> genePool = <span class="type">Array</span>[<span class="type">Char</span>](&#x27;<span class="number">1</span>&#x27;,&#x27;<span class="number">0</span>&#x27;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">implicit</span> <span class="keyword">val</span> _: <span class="type">Logger</span> = logger.underlying</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç»Ÿè®¡ç›¸ç­‰çš„ä¸ªæ•°</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">fitness</span></span>(src: <span class="type">String</span>, tgt: <span class="type">String</span>): <span class="type">Double</span> = src.zip(tgt).count &#123; <span class="keyword">case</span> (s, t) =&gt; s == t &#125;</span><br><span class="line">  <span class="comment">// å†²çªæ¶ˆé™¤ todo:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">conflictClear</span></span>(agents: <span class="type">Seq</span>[<span class="type">String</span>]): <span class="type">Seq</span>[<span class="type">String</span>] = agents</span><br><span class="line"></span><br><span class="line">  <span class="keyword">val</span> testBench = <span class="keyword">new</span> <span class="type">GeneticExploration</span>[<span class="type">Char</span>, <span class="type">String</span>](<span class="number">0.5</span>, <span class="number">0.01</span>, <span class="number">10</span>, genePool, cs =&gt; <span class="keyword">new</span> <span class="type">String</span>(cs.toArray), conflictClear, fitness)</span><br><span class="line">  <span class="keyword">val</span> (p, g) = testBench.evolution(testBench.newPool(<span class="number">10</span>, target.length), target)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @param cross crossover probability äº¤å‰æ¦‚ç‡</span></span><br><span class="line"><span class="comment">  * @param mutation å˜å¼‚æ¦‚ç‡</span></span><br><span class="line"><span class="comment">  * @param population ç§ç¾¤æ•°é‡</span></span><br><span class="line"><span class="comment">  * @param genePool åŸºå› æ± </span></span><br><span class="line"><span class="comment">  * @param specimenBuilder ä¸ªä½“æ„é€ å™¨</span></span><br><span class="line"><span class="comment">  * @param conflictClear   å†²çªæ¶ˆé™¤ Rmä¸ºç¡¬çº¦æŸæ¡ä»¶ï¼›Rnä¸ºè½¯çº¦æŸæ¡ä»¶ï¼›Rxä¸ºè§£ä¿è¯</span></span><br><span class="line"><span class="comment">  * @param fitnessF é€‚å€¼å‡½æ•°</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GeneticExploration</span>[<span class="type">Gene</span>, <span class="type">Specimen</span>](<span class="params">val cross: <span class="type">Double</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                                         val mutation: <span class="type">Double</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                                         val population: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                                         genePool: <span class="type">Array</span>[<span class="type">Gene</span>],</span></span></span><br><span class="line"><span class="params"><span class="class">                                         specimenBuilder: <span class="type">Iterable</span>[<span class="type">Gene</span>] =&gt; <span class="type">Specimen</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                                         conflictClear: <span class="type">Seq</span>[<span class="type">Specimen</span>] =&gt; <span class="type">Seq</span>[<span class="type">Specimen</span>],</span></span></span><br><span class="line"><span class="params"><span class="class">                                         fitnessF: (<span class="type">Specimen</span>, <span class="type">Specimen</span></span>) <span class="title">=&gt;</span> <span class="title">Double</span>)(<span class="params">implicit ev$1: <span class="type">Specimen</span> =&gt; <span class="type">Iterable</span>[<span class="type">Gene</span>], logger: <span class="type">Logger</span></span>) </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">type</span> <span class="title">Pool</span> </span>= <span class="type">Seq</span>[<span class="type">Specimen</span>]</span><br><span class="line">  <span class="class"><span class="keyword">type</span> <span class="title">MatePool</span> </span>= <span class="type">Seq</span>[(<span class="type">Specimen</span>, <span class="type">Double</span>)]</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">randomGenes</span></span>: <span class="type">Stream</span>[<span class="type">Gene</span>] = genePool(<span class="type">Random</span>.nextInt(genePool.length)) #:: randomGenes</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">newSpecimen</span></span>(len: <span class="type">Int</span>): <span class="type">Specimen</span> = specimenBuilder(randomGenes.take(len))</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">newPool</span></span>(size: <span class="type">Int</span>, len: <span class="type">Int</span>): <span class="type">Pool</span> = (<span class="number">1</span> to size).map(_ =&gt; newSpecimen(len))</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">matePool</span></span>(pool: <span class="type">Pool</span>, tgt: <span class="type">Specimen</span>): <span class="type">MatePool</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> fitnesses: <span class="type">Seq</span>[<span class="type">Double</span>] = pool.map(fitnessF(_, tgt))</span><br><span class="line">    pool.zip(renormalize(fitnesses))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** æ¯ä¸ªä¸ªä½“è¢«é€‰ä¸­çš„æ¦‚ç‡ */</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">renormalize</span></span>(vector: <span class="type">Iterable</span>[<span class="type">Double</span>]): <span class="type">Iterable</span>[<span class="type">Double</span>] = &#123;</span><br><span class="line">    <span class="keyword">val</span> sum = vector.sum</span><br><span class="line">    vector.map(_ / sum)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** è’™ç‰¹å¡ç½—é€‰ä¸¾ï¼Œä¼ªéšæœºç”Ÿæˆä¸ªä½“ */</span></span><br><span class="line">  <span class="meta">@tailrec</span> <span class="keyword">final</span> <span class="function"><span class="keyword">def</span> <span class="title">monteCarloSelection</span></span>(matePool: <span class="type">MatePool</span>): <span class="type">Specimen</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> (specimen, fitness) = matePool(<span class="type">Random</span>.nextInt(matePool.length))</span><br><span class="line">    <span class="comment">// å­ä»£é€‚å€¼å¤§äºçˆ¶ä»£é€‚å€¼ï¼ŸY æ›¿æ¢ N ä¿æŒ</span></span><br><span class="line">    <span class="keyword">if</span> (fitness &gt; <span class="type">Random</span>.nextFloat()) specimen <span class="keyword">else</span> monteCarloSelection(matePool)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** äº§ç”Ÿæ–°ç”Ÿä»£ */</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">popReproduction</span></span>(matePool: <span class="type">MatePool</span>): <span class="type">Pool</span> =</span><br><span class="line">    (<span class="number">1</span> to population)</span><br><span class="line">      .par</span><br><span class="line">      .map(_ =&gt; crossover(monteCarloSelection(matePool), monteCarloSelection(matePool)))</span><br><span class="line">      .map(mutate)</span><br><span class="line">      ./:(<span class="type">Seq</span>[<span class="type">Specimen</span>]())(conflictDetection)</span><br><span class="line">      .seq</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** è¿›è¡Œäº¤å‰æ“ä½œï¼Œäº¤å‰æ¦‚ç‡ Pc */</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">crossover</span></span>(a: <span class="type">Specimen</span>, b: <span class="type">Specimen</span>): <span class="type">Specimen</span> = specimenBuilder(a.zip(b).map(gene =&gt; <span class="keyword">if</span> (<span class="type">Random</span>.nextFloat &gt; cross) gene._1 <span class="keyword">else</span> gene._2))</span><br><span class="line">  <span class="comment">/** è¿›è¡Œå˜å¼‚æ“ä½œï¼Œå˜å¼‚æ¦‚ç‡ Pm */</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">mutate</span></span>(s: <span class="type">Specimen</span>): <span class="type">Specimen</span> = specimenBuilder(s.map(gene =&gt; <span class="keyword">if</span> (mutation &gt; <span class="type">Random</span>.nextFloat) randomGenes.head <span class="keyword">else</span> gene))</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ–°ç”Ÿæˆçš„ç§ç¾¤éœ€è¦åš &#x27;&#x27;&#x27;å†²çªæ£€æµ‹ä¸æ¶ˆé™¤æ“ä½œ&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">    * ä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="comment">    * 001,001   =&gt;  (a,Î±)</span></span><br><span class="line"><span class="comment">    * 001,010   =&gt;  (a,Î²)</span></span><br><span class="line"><span class="comment">    * 010,110   =&gt;  (b,Î¶)</span></span><br><span class="line"><span class="comment">    * éšæœºæ£€æµ‹å‘ç° &#x27;&#x27;&#x27;(a,Î±)&#x27;&#x27;&#x27; å’Œ &#x27;&#x27;&#x27;(a,Î²)&#x27;&#x27;&#x27;å†²çªã€‚éšæœºè·å–å†²çªä¹‹å¤–çš„ä»»æ„å€¼ &#x27;&#x27;&#x27;(b,Î¶)&#x27;&#x27;&#x27;ï¼Œæ›¿æ¢ä¸ºï¼š</span></span><br><span class="line"><span class="comment">    * 001,001   =&gt;  (a,Î±)</span></span><br><span class="line"><span class="comment">    * 010,010   =&gt;  (b,Î²)</span></span><br><span class="line"><span class="comment">    * 001,110   =&gt;  (a,Î¶)</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * ä¾æ¬¡å¾ªç¯ï¼Œç›´åˆ°cursorç­‰äºç§ç¾¤å¤§å°ã€‚ç¡®ä¿æ¯æ¬¡è¿›åŒ–ç§ç¾¤ä¸ªä½“ä¸é‡å¤ã€‚æ–¹ä¾¿å¿«é€Ÿæ”¶æ•›</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">conflictDetection</span></span>(z: <span class="type">Pool</span>, b: <span class="type">Specimen</span>): <span class="type">Pool</span> = &#123;</span><br><span class="line">    <span class="meta">@tailrec</span> <span class="function"><span class="keyword">def</span> <span class="title">_conflictRif</span></span>(e: <span class="type">Specimen</span>): <span class="type">Specimen</span> =</span><br><span class="line">      <span class="keyword">if</span> (!z.contains(e)) e</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> x = mutate(e)</span><br><span class="line">        <span class="keyword">if</span> (z.contains(x)) _conflictRif(e)</span><br><span class="line">        <span class="keyword">else</span> x</span><br><span class="line">      &#125;</span><br><span class="line">    conflictClear(z :+ _conflictRif(b))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** é—ä¼ è¿›åŒ–æ“ä½œï¼Œå°†é€‚å€¼è¾ƒé«˜çš„ä¸ªä½“é€‰æ‹©å‡ºæ¥ï¼Œå¹¶å°†å…¶ä¼˜ç§€çš„åŸºå› ä¼ é€’ç»™ä¸‹ä¸€ä»£ */</span></span><br><span class="line">  <span class="meta">@tailrec</span> <span class="keyword">final</span> <span class="function"><span class="keyword">def</span> <span class="title">evolution</span></span>(pool: <span class="type">Pool</span>, target: <span class="type">Specimen</span>, generation: <span class="type">Int</span> = <span class="number">0</span>): (<span class="type">Pool</span>, <span class="type">Int</span>) = &#123;</span><br><span class="line">    <span class="keyword">val</span> newGeneration = popReproduction(matePool(pool, target))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ===========================================</span></span><br><span class="line">    logger.debug(<span class="string">s&quot;ç¬¬<span class="subst">$&#123;Console.RED&#125;</span>[&#123;&#125;]<span class="subst">$&#123;Console.RESET&#125;</span>ä»£ å‘ ç¬¬<span class="subst">$&#123;Console.RED&#125;</span>[&#123;&#125;]<span class="subst">$&#123;Console.RESET&#125;</span>ä»£è¿›åŒ–: &quot;</span>, generation, generation + <span class="number">1</span>)</span><br><span class="line">    logger.debug(<span class="string">&quot;&quot;</span>)</span><br><span class="line">    pool.zip(newGeneration).collect&#123; <span class="keyword">case</span> (s, t) =&gt;</span><br><span class="line">      <span class="keyword">if</span> (t.equals(target))</span><br><span class="line">        logger.debug(<span class="string">s&quot;<span class="subst">$&#123;s.mkString&#125;</span> -&gt; <span class="subst">$&#123;Console.BLACK_B&#125;</span><span class="subst">$&#123;Console.GREEN&#125;</span><span class="subst">$t</span><span class="subst">$&#123;Console.RESET&#125;</span>&quot;</span>)</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        logger.debug(<span class="string">s&quot;<span class="subst">$&#123;s.mkString&#125;</span> -&gt; <span class="subst">$&#123;t.mkString&#125;</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ===========================================</span></span><br><span class="line">    <span class="keyword">if</span> (newGeneration.contains(target)) (newGeneration, generation)</span><br><span class="line">    <span class="keyword">else</span> evolution(newGeneration, target, generation + <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/img/algorithm/ga/gatest.png" alt="æµ‹è¯•ç»“æœ"></p>
<h2 id="é—ä¼ ç®—æ³•å®ç°è‡ªåŠ¨æ’è¯¾"><a class="header-anchor" href="#é—ä¼ ç®—æ³•å®ç°è‡ªåŠ¨æ’è¯¾">Â¶</a>é—ä¼ ç®—æ³•å®ç°è‡ªåŠ¨æ’è¯¾</h2>
<p>ç‚¹å‡»<a target="_blank" rel="noopener" href="https://github.com/barudisshu/syllabus">è¿™é‡Œ</a>è·å–æºç ã€‚</p>
</div></article><nav class="article-nav"><div class="article-nav-prev">ğŸ”™<a href="/2018/09/14/youtrack/youtrack-install/">YouTrack å¿«é€Ÿå®‰è£…</a></div><div class="article-nav-next">ğŸ”œ<a href="/2018/07/16/mysql/mysql-master-slave-config/">å®è·µMySQLä¸»ä»å¤åˆ¶(Master-Slave)çš„æ“ä½œæµç¨‹ï¼</a></div></nav><div id="base-discus"><div id="disqus_thread"></div><script>var disqus_shortname = 'barudisshu-github-io';
var disqus_identifier = '2018/07/24/algorithm/ga/genetic-algorithm/';
var disqus_title = 'åŸºäºé—ä¼ ç®—æ³•å®ç°æ’è¯¾ç³»ç»Ÿ';
var disqus_url = 'https://galudisu.info/2018/07/24/algorithm/ga/genetic-algorithm/';
(function () {
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async>  </script></div></div></div><footer class="base-footer"><div class="footer-wrapper"><span>Â©2016 - 2025 <a href="https://galudisu.info">barudisshu</a>, unless otherwise noted.</span></div></footer><div class="dom-ready">
<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>

<link rel="stylesheet" href="//cdn.bootcss.com/pace/1.0.2/themes/green/pace-theme-flash.min.css">

<script src="/js/base.js"></script>

<script src="/js/rabbit-lyrics.js"></script>
</div></body></html>