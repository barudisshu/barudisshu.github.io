<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><title>CentOS 7.5 æ­å»ºZookeeperé›†ç¾¤ä¸å‘½ä»¤è¡Œæ“ä½œ</title>
<link rel="stylesheet" href="/css/layout.css">
<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="/css/vendors/rabbit-lyrics.css">
<link rel="shortcut icon" href="/img/favicon.ico"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•" type="application/atom+xml">
</head><body><header class="base-menu"><div class="menu-wrapper"><div class="menu-layout-bg"></div><nav class="menu-content"><ul class="menu-list"><li class="menu-item"><a class="menu-link" href="/">ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•</a></li><li class="menu-item"><a class="menu-link" href="/archives/">Archives</a></li><li class="menu-item"><a class="menu-link" target="_blank" rel="noopener" href="http://weibo.com/u/2360401155">Weibo</a></li><li class="menu-item"><a class="menu-link" href="/about">About</a></li><li class="menu-item"><a class="menu-link" href="/atom.xml">Rss</a></li></ul></nav></div></header><header class="base-mobile-menu"><div class="mobile-menu-wrapper"><div class="menu-layout-bg"></div><nav class="menu-content"><ul class="menu-list"><li class="menu-item"><a class="menu-link" href="/">ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•</a></li><li class="menu-item"><a class="menu-link" href="/archives/">Archives</a></li><li class="menu-item"><a class="menu-link" target="_blank" rel="noopener" href="http://weibo.com/u/2360401155">Weibo</a></li><li class="menu-item"><a class="menu-link" href="/about">About</a></li><li class="menu-item"><a class="menu-link" href="/atom.xml">Rss</a></li></ul></nav><div class="toggle-menu" id="mobile-menu-toggle"><span class="menu-bar"></span><span class="menu-bar"> </span><span class="menu-bar"></span></div></div></header><div class="base-content"><div class="base-content-main"><article class="article-main"><h1 class="article-title">CentOS 7.5 æ­å»ºZookeeperé›†ç¾¤ä¸å‘½ä»¤è¡Œæ“ä½œ</h1><div class="article-meta"><p class="meta-item meta-time"><span class="meta-item-title"></span><i class="icon-calendar"> </i>2018-10-21</p><p class="meta-item meta-tag"><span class="meta-item-title"></span><i class="icon-tag"> </i><a class="tag-link" href="/tags/zookeeper/">zookeeper</a></p></div><div class="article-content"><span id="more"></span>
<h2 id="åˆ†å¸ƒå¼å®‰è£…éƒ¨ç½²"><a class="header-anchor" href="#åˆ†å¸ƒå¼å®‰è£…éƒ¨ç½²">Â¶</a>åˆ†å¸ƒå¼å®‰è£…éƒ¨ç½²</h2>
<p>å®˜ç½‘é¦–é¡µï¼š<a target="_blank" rel="noopener" href="https://zookeeper.apache.org/">https://zookeeper.apache.org/</a><br>
ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="http://mirror.bit.edu.cn/apache/zookeeper/">http://mirror.bit.edu.cn/apache/zookeeper/</a></p>
<p><img src="/img/spark/zookeeper-releases.png" alt="zookeeper-release"></p>
<h3 id="é›†ç¾¤è§„åˆ’"><a class="header-anchor" href="#é›†ç¾¤è§„åˆ’">Â¶</a>é›†ç¾¤è§„åˆ’</h3>
<p>åœ¨node1ï¼Œnode2å’Œnode3ä¸‰ä¸ªèŠ‚ç‚¹ä¸Šéƒ¨ç½²zookeeperï¼Œä¸‰ä¸ªèŠ‚ç‚¹éƒ½å·²å®‰è£…jdkã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center">IP</th>
<th style="text-align:center">èŠ‚ç‚¹åç§°</th>
<th style="text-align:center">zookeeper</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">192.168.100.21</td>
<td style="text-align:center">spark-node1</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">192.168.100.22</td>
<td style="text-align:center">spark-node2</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">192.168.100.23</td>
<td style="text-align:center">spark-node3</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h3 id="è§£å‹å®‰è£…"><a class="header-anchor" href="#è§£å‹å®‰è£…">Â¶</a>è§£å‹å®‰è£…</h3>
<ol>
<li>è§£å‹zookeeperæŒ‰è½¬åŒ…åˆ°<code>/opt/</code>ç›®å½•ä¸‹</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf zookeeper-3.4.12.tar.gz -C /opt/</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>åœ¨<code>/opt/</code> åˆ›å»ºè½¯è¿æ¥</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /opt/zookeeper-3.4.12 /opt/zookeeper</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>åœ¨<code>/opt/zookeeper</code>ç›®å½•ä¸‹åˆ›å»ºdata</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /opt/zookeeper/data</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>è¦†ç›–zookeeperçš„å®‰è£…é…ç½®</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv /opt/zookeeper/conf/zoo_sample.cfg /opt/zookeeper/conf/zoo.cfg</span><br></pre></td></tr></table></figure>
<h3 id="é…ç½®zoo-cfgæ–‡ä»¶"><a class="header-anchor" href="#é…ç½®zoo-cfgæ–‡ä»¶">Â¶</a>é…ç½®zoo.cfgæ–‡ä»¶</h3>
<p>å…·ä½“é…ç½®ï¼Œä¿®æ”¹dateDirï¼Œæ·»åŠ æ—¥å¿—å­˜æ”¾ç›®å½•</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dataDir=/opt/zookeeper/data</span><br><span class="line">dataLogDir=/opt/zookeeper/logs</span><br></pre></td></tr></table></figure>
<p>æœ«å°¾å¢åŠ å¦‚ä¸‹é…ç½®</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.1=spark-node1:2888:3888</span><br><span class="line">server.2=spark-node2:2888:3888</span><br><span class="line">server.3=spark-node3:2888:3888</span><br></pre></td></tr></table></figure>
<h3 id="é›†ç¾¤é…ç½®"><a class="header-anchor" href="#é›†ç¾¤é…ç½®">Â¶</a>é›†ç¾¤é…ç½®</h3>
<ol>
<li>åœ¨<code>/opt/zookeeper/data</code>ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªmyidçš„æ–‡ä»¶</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch myid</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>ç¼–è¾‘myidæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­æ·»åŠ ä¸serverå¯¹åº”çš„ç¼–å·ï¼šå¦‚ 1</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim myid</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>æ‹·è´é…ç½®å¥½çš„zookeeperåˆ°å…¶å®ƒæœºå™¨ä¸Š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r zookeeper*/ xxx@spark-node2:/opt/</span><br><span class="line">scp -r zookeeper*/ xxx@spark-node3:/opt/</span><br></pre></td></tr></table></figure>
<p>å¹¶ä¿®æ”¹spark-node2ï¼Œspark-node3ä¸­myidæ–‡ä»¶ä¸­å†…å®¹ä¸º2ã€3</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo 2 &gt; myid</span><br><span class="line">echo 3 &gt; myid</span><br></pre></td></tr></table></figure>
<h3 id="å¯åŠ¨é›†ç¾¤"><a class="header-anchor" href="#å¯åŠ¨é›†ç¾¤">Â¶</a>å¯åŠ¨é›†ç¾¤</h3>
<ol>
<li>åˆ†åˆ«å¯åŠ¨zookeeper</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bin/zkServer.sh start</span><br><span class="line">bin/zkServer.sh start</span><br><span class="line">bin/zkServer.sh start</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>æŸ¥çœ‹çŠ¶æ€</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bin/zkServer.sh status</span><br><span class="line">ZooKeeper JMX enabled by default</span><br><span class="line">Using config: /opt/zookeeper-3.4.12/bin/../conf/zoo.cfg</span><br><span class="line">Mode: follwer</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>åœæ­¢zookeeper</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/zkServer.sh stop</span><br></pre></td></tr></table></figure>
<h3 id="åŠ å…¥Systemdç®¡ç†"><a class="header-anchor" href="#åŠ å…¥Systemdç®¡ç†">Â¶</a>åŠ å…¥Systemdç®¡ç†</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/lib/systemd/system/zookeeper.service</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description=Zookeeper service</span><br><span class="line">After=syslog.target etwork.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">Environment=ZOO_LOG_DIR=/opt/zookeeper/data/logs</span><br><span class="line">ExecStart=/opt/zookeeper/bin/zkServer.sh start</span><br><span class="line">ExecStop=/opt/zookeeper/bin/zkServer.sh stop</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>
<h3 id="é…ç½®ç¯å¢ƒå˜é‡"><a class="header-anchor" href="#é…ç½®ç¯å¢ƒå˜é‡">Â¶</a>é…ç½®ç¯å¢ƒå˜é‡</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line">export ZOOKEEPER_HOME=/opt/zookeeper-3.4.12 </span><br><span class="line">export PATH=$PATH:$ZOOKEEPER_HOME/bin</span><br></pre></td></tr></table></figure>
<h3 id="zoo-cfgé…ç½®å‚æ•°è§£è¯»"><a class="header-anchor" href="#zoo-cfgé…ç½®å‚æ•°è§£è¯»">Â¶</a>zoo.cfgé…ç½®å‚æ•°è§£è¯»</h3>
<p>Server.A=B:C:Dã€‚</p>
<p>Aæ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºè¿™ä¸ªæ˜¯ç¬¬å‡ å·æœåŠ¡å™¨ï¼›</p>
<p>Bæ˜¯è¿™ä¸ªæœåŠ¡å™¨çš„ipåœ°å€ï¼›</p>
<p>Cæ˜¯è¿™ä¸ªæœåŠ¡å™¨ä¸é›†ç¾¤ä¸­çš„LeaderæœåŠ¡å™¨äº¤æ¢ä¿¡æ¯çš„ç«¯å£ï¼›</p>
<p>Dæ˜¯ä¸‡ä¸€é›†ç¾¤ä¸­çš„LeaderæœåŠ¡å™¨æŒ‚äº†ï¼Œéœ€è¦ä¸€ä¸ªç«¯å£æ¥é‡æ–°è¿›è¡Œé€‰ä¸¾ï¼Œé€‰å‡ºä¸€ä¸ªæ–°çš„Leaderï¼Œè€Œè¿™ä¸ªç«¯å£å°±æ˜¯ç”¨æ¥æ‰§è¡Œé€‰ä¸¾æ—¶æœåŠ¡å™¨ç›¸äº’é€šä¿¡çš„ç«¯å£ã€‚</p>
<p>é›†ç¾¤æ¨¡å¼ä¸‹é…ç½®ä¸€ä¸ªæ–‡ä»¶myidï¼Œè¿™ä¸ªæ–‡ä»¶åœ¨dataDirç›®å½•ä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œé¢æœ‰ä¸€ä¸ªæ•°æ®å°±æ˜¯Açš„å€¼ï¼ŒZookeeperå¯åŠ¨æ—¶è¯»å–æ­¤æ–‡ä»¶ï¼Œæ‹¿åˆ°é‡Œé¢çš„æ•°æ®ä¸zoo.cfgé‡Œé¢çš„é…ç½®ä¿¡æ¯æ¯”è¾ƒä»è€Œåˆ¤æ–­åˆ°åº•æ˜¯å“ªä¸ªserverã€‚</p>
<ol>
<li>tickTime=2000ï¼šé€šä¿¡å¿ƒè·³æ•°</li>
</ol>
<p>tickTimeï¼šé€šä¿¡å¿ƒè·³æ•°ï¼ŒZookeeperæœåŠ¡å™¨å¿ƒè·³æ—¶é—´ï¼Œå•ä½æ¯«ç§’</p>
<p>Zookeeperä½¿ç”¨çš„åŸºæœ¬æ—¶é—´ï¼ŒæœåŠ¡å™¨ä¹‹é—´æˆ–å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ç»´æŒå¿ƒè·³çš„æ—¶é—´é—´éš”ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªtickTimeæ—¶é—´å°±ä¼šå‘é€ä¸€ä¸ªå¿ƒè·³ï¼Œæ—¶é—´å•ä½ä¸ºæ¯«ç§’ã€‚</p>
<p>å®ƒç”¨äºå¿ƒè·³æœºåˆ¶ï¼Œå¹¶ä¸”è®¾ç½®æœ€å°çš„sessionè¶…æ—¶æ—¶é—´ä¸ºä¸¤å€å¿ƒè·³æ—¶é—´ã€‚(sessionçš„æœ€å°è¶…æ—¶æ—¶é—´æ˜¯2 x tickTime)</p>
<p>2)initLimit=10ï¼šLFåˆå§‹é€šä¿¡æ—¶é™</p>
<p>é›†ç¾¤ä¸­çš„followerè·Ÿéšè€…æœåŠ¡å™¨(F)ä¸leaderé¢†å¯¼è€…æœåŠ¡å™¨(L)ä¹‹é—´åˆå§‹è¿æ¥æ—¶èƒ½å®¹å¿çš„æœ€å¤šå¿ƒè·³æ•°ï¼ˆtickTimeçš„æ•°é‡ï¼‰ï¼Œç”¨å®ƒæ¥é™å®šé›†ç¾¤ä¸­çš„ZookeeperæœåŠ¡å™¨è¿æ¥åˆ°Leaderçš„æ—¶é™ã€‚</p>
<p>æŠ•ç¥¨é€‰ä¸¾æ–°leaderçš„åˆå§‹åŒ–æ—¶é—´</p>
<p>Followeråœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œä¼šä»LeaderåŒæ­¥æ‰€æœ‰æœ€æ–°æ•°æ®ï¼Œç„¶åç¡®å®šè‡ªå·±èƒ½å¤Ÿå¯¹å¤–æœåŠ¡çš„èµ·å§‹çŠ¶æ€ã€‚</p>
<p>Leaderå…è®¸Fåœ¨initLimitæ—¶é—´å†…å®Œæˆè¿™ä¸ªå·¥ä½œã€‚</p>
<p>3)syncLimit=5ï¼šLFåŒæ­¥é€šä¿¡æ—¶é™</p>
<p>é›†ç¾¤ä¸­Leaderä¸Followerä¹‹é—´çš„æœ€å¤§å“åº”æ—¶é—´å•ä½ï¼Œå‡å¦‚å“åº”è¶…è¿‡syncLimit x tickTimeï¼Œ</p>
<p>Leaderè®¤ä¸ºFollweræ­»æ‰ï¼Œä»æœåŠ¡å™¨åˆ—è¡¨ä¸­åˆ é™¤Follwerã€‚</p>
<p>åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼ŒLeaderè´Ÿè´£ä¸ZKé›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨è¿›è¡Œé€šä¿¡ï¼Œä¾‹å¦‚é€šè¿‡ä¸€äº›å¿ƒè·³æ£€æµ‹æœºåˆ¶ï¼Œæ¥æ£€æµ‹æœºå™¨çš„å­˜æ´»çŠ¶æ€ã€‚</p>
<p>å¦‚æœLå‘å‡ºå¿ƒè·³åŒ…åœ¨syncLimitä¹‹åï¼Œè¿˜æ²¡æœ‰ä»Fé‚£æ”¶åˆ°å“åº”ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºè¿™ä¸ªFå·²ç»ä¸åœ¨çº¿äº†ã€‚</p>
<p>4)dataDirï¼šæ•°æ®æ–‡ä»¶ç›®å½•+æ•°æ®æŒä¹…åŒ–è·¯å¾„</p>
<p>ä¿å­˜å†…å­˜æ•°æ®åº“å¿«ç…§ä¿¡æ¯çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–è¯´æ˜ï¼Œæ›´æ–°çš„äº‹åŠ¡æ—¥å¿—ä¹Ÿä¿å­˜åˆ°æ•°æ®åº“ã€‚</p>
<p>5)clientPort=2181ï¼šå®¢æˆ·ç«¯è¿æ¥ç«¯å£</p>
<p>ç›‘å¬å®¢æˆ·ç«¯è¿æ¥çš„ç«¯å£</p>
<h2 id="å®¢æˆ·ç«¯å‘½ä»¤è¡Œæ“ä½œ"><a class="header-anchor" href="#å®¢æˆ·ç«¯å‘½ä»¤è¡Œæ“ä½œ">Â¶</a>å®¢æˆ·ç«¯å‘½ä»¤è¡Œæ“ä½œ</h2>
<ol>
<li>å¯åŠ¨å®¢æˆ·ç«¯</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zkCli.sh</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>æ˜¾ç¤ºæ‰€æœ‰æ“ä½œå‘½ä»¤</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 0] help</span><br><span class="line">ZooKeeper -server host:port cmd args</span><br><span class="line">    stat path [watch]</span><br><span class="line">    set path data [version]</span><br><span class="line">    ls path [watch]</span><br><span class="line">    delquota [-n|-b] path</span><br><span class="line">    ls2 path [watch]</span><br><span class="line">    setAcl path acl</span><br><span class="line">    setquota -n|-b val path</span><br><span class="line">    history </span><br><span class="line">    redo cmdno</span><br><span class="line">    printwatches on|off</span><br><span class="line">    delete path [version]</span><br><span class="line">    sync path</span><br><span class="line">    listquota path</span><br><span class="line">    rmr path</span><br><span class="line">    get path [watch]</span><br><span class="line">    create [-s] [-e] path data acl</span><br><span class="line">    addauth scheme auth</span><br><span class="line">    quit </span><br><span class="line">    getAcl path</span><br><span class="line">    close </span><br><span class="line">    connect host:port</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>æŸ¥çœ‹å½“å‰znodeä¸­æ‰€åŒ…å«çš„å†…å®¹</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 1] ls /</span><br><span class="line">[zookeeper]</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>æŸ¥çœ‹å½“å‰èŠ‚ç‚¹æ•°æ®å¹¶èƒ½çœ‹åˆ°æ›´æ–°æ¬¡æ•°ç­‰æ•°æ®</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 2] ls2 /</span><br><span class="line">[zookeeper]</span><br><span class="line">cZxid = 0x0</span><br><span class="line">ctime = Wed Dec 31 19:00:00 EST 1969</span><br><span class="line">mZxid = 0x0</span><br><span class="line">mtime = Wed Dec 31 19:00:00 EST 1969</span><br><span class="line">pZxid = 0x0</span><br><span class="line">cversion = -1</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 0</span><br><span class="line">numChildren = 1</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>åˆ›å»ºæ™®é€šèŠ‚ç‚¹</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 3] create /opt &quot;aa&quot;</span><br><span class="line">Created /opt</span><br><span class="line">[zk: localhost:2181(CONNECTED) 4] create /opt/s &quot;bb&quot;</span><br><span class="line">Created /opt</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>è·å–èŠ‚ç‚¹å€¼</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 5] get /opt</span><br><span class="line">aa</span><br><span class="line">cZxid = 0x4100000004</span><br><span class="line">ctime = Wed Jul 25 07:48:55 EDT 2018</span><br><span class="line">mZxid = 0x4100000004</span><br><span class="line">mtime = Wed Jul 25 07:48:55 EDT 2018</span><br><span class="line">pZxid = 0x4100000005</span><br><span class="line">cversion = 1</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 2</span><br><span class="line">numChildren = 1</span><br><span class="line">[zk: localhost:2181(CONNECTED) 6] get /opt/s</span><br><span class="line">bb</span><br><span class="line">cZxid = 0x4100000005</span><br><span class="line">ctime = Wed Jul 25 07:51:21 EDT 2018</span><br><span class="line">mZxid = 0x4100000005</span><br><span class="line">mtime = Wed Jul 25 07:51:21 EDT 2018</span><br><span class="line">pZxid = 0x4100000005</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 2</span><br><span class="line">numChildren = 0</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>åˆ›å»ºçŸ­æš‚èŠ‚ç‚¹</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 7] create -e /app 8888           </span><br><span class="line">Created /app</span><br></pre></td></tr></table></figure>
<p>åœ¨å½“å‰å®¢æˆ·ç«¯æ˜¯èƒ½æŸ¥çœ‹åˆ°çš„</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 8] ls /</span><br><span class="line">[app, opt, zookeeper]</span><br></pre></td></tr></table></figure>
<p>é€€å‡ºå½“å‰å®¢æˆ·ç«¯ç„¶åå†é‡å¯å®¢æˆ·ç«¯</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 9] quit</span><br><span class="line">[root@spark-node2 zookeepe]$ bin/zkCli.sh</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡æŸ¥çœ‹æ ¹ç›®å½•ä¸‹çŸ­æš‚èŠ‚ç‚¹å·²ç»åˆ é™¤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 0] ls /</span><br><span class="line">[opt, zookeeper]</span><br></pre></td></tr></table></figure>
<ol start="8">
<li>åˆ›å»ºå¸¦åºå·çš„èŠ‚ç‚¹</li>
</ol>
<p>å…ˆåˆ›å»ºä¸€ä¸ªæ™®é€šçš„æ ¹èŠ‚ç‚¹app</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 1] create /app &quot;app&quot;</span><br><span class="line">create /app &quot;app&quot;</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºå¸¦åºå·çš„èŠ‚ç‚¹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 2] create -s /app/aa 888</span><br><span class="line">Created /app/aa0000000000</span><br><span class="line">[zk: localhost:2181(CONNECTED) 3] create -s /app/bb 888</span><br><span class="line">Created /app/bb0000000001</span><br><span class="line">[zk: localhost:2181(CONNECTED) 4] create -s /app/cc 888</span><br><span class="line">Created /app/cc0000000002</span><br></pre></td></tr></table></figure>
<p>å¦‚æœåŸèŠ‚ç‚¹ä¸‹æœ‰1ä¸ªèŠ‚ç‚¹ï¼Œåˆ™åœ¨æ’åºæ—¶ä»1å¼€å§‹ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 5] create -s /opt/aa 888</span><br><span class="line">Created /opt/aa0000000001</span><br></pre></td></tr></table></figure>
<ol start="9">
<li>ä¿®æ”¹èŠ‚ç‚¹æ•°æ®å€¼</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 6] set /opt 999</span><br><span class="line">cZxid = 0x4100000004</span><br><span class="line">ctime = Wed Jul 25 07:48:55 EDT 2018</span><br><span class="line">mZxid = 0x410000000e</span><br><span class="line">mtime = Wed Jul 25 08:14:18 EDT 2018</span><br><span class="line">pZxid = 0x410000000d</span><br><span class="line">cversion = 2</span><br><span class="line">dataVersion = 1</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 3</span><br><span class="line">numChildren = 2</span><br></pre></td></tr></table></figure>
<ol start="10">
<li>èŠ‚ç‚¹çš„å€¼å˜åŒ–ç›‘å¬</li>
</ol>
<p>åœ¨spark-node2ä¸»æœºä¸Šæ³¨å†Œç›‘å¬/optèŠ‚ç‚¹æ•°æ®å˜åŒ–</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zkCli.sh</span><br><span class="line">[zk: localhost:2181(CONNECTED) 0] get /opt watch</span><br></pre></td></tr></table></figure>
<p>åœ¨spark-node1ä¸»æœºä¸Šä¿®æ”¹/optèŠ‚ç‚¹çš„æ•°æ®</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 7] set /opt 777</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿspark-node2ä¸»æœºæ”¶åˆ°æ•°æ®å˜åŒ–çš„ç›‘å¬</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 1] </span><br><span class="line">WATCHER::</span><br><span class="line"></span><br><span class="line">WatchedEvent state:SyncConnected type:NodeDataChanged path:/opt</span><br></pre></td></tr></table></figure>
<ol start="11">
<li>èŠ‚ç‚¹çš„å­èŠ‚ç‚¹å˜åŒ–ç›‘å¬(è·¯å¾„å˜åŒ–)</li>
</ol>
<p>åœ¨spark-node2ä¸»æœºä¸Šæ³¨å†Œç›‘å¬/optèŠ‚ç‚¹çš„å­èŠ‚ç‚¹å˜åŒ–</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 2] ls /opt watch</span><br><span class="line">[aa0000000001, module]</span><br></pre></td></tr></table></figure>
<p>åœ¨spark-node2ä¸»æœº/optèŠ‚ç‚¹ä¸Šåˆ›å»ºå­èŠ‚ç‚¹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 8] create /opt/bb 666</span><br><span class="line">Created /opt/bb</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿspark-node2ä¸»æœºæ”¶åˆ°å­èŠ‚ç‚¹å˜åŒ–çš„ç›‘å¬</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 3] </span><br><span class="line">WATCHER::</span><br><span class="line"></span><br><span class="line">WatchedEvent state:SyncConnected type:NodeChildrenChanged path:/opt</span><br></pre></td></tr></table></figure>
<ol start="12">
<li>åˆ é™¤èŠ‚ç‚¹</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 9] delete /opt/bb</span><br></pre></td></tr></table></figure>
<ol start="13">
<li>é€’å½’åˆ é™¤èŠ‚ç‚¹</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 10] rmr /opt</span><br></pre></td></tr></table></figure>
<ol start="14">
<li>æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 14] stat /app</span><br><span class="line">cZxid = 0x4100000009</span><br><span class="line">ctime = Wed Jul 25 08:09:56 EDT 2018</span><br><span class="line">mZxid = 0x4100000009</span><br><span class="line">mtime = Wed Jul 25 08:09:56 EDT 2018</span><br><span class="line">pZxid = 0x410000000c</span><br><span class="line">cversion = 3</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 3</span><br><span class="line">numChildren = 3</span><br></pre></td></tr></table></figure>
<ol start="15">
<li>é€€å‡ºå®¢æˆ·ç«¯</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 17] quit</span><br></pre></td></tr></table></figure>
</div></article><nav class="article-nav"><div class="article-nav-prev">ğŸ”™<a href="/2018/10/21/spark/spark-zookeeper-2/">ZookeeperåŸç†ä¸APIåº”ç”¨</a></div><div class="article-nav-next">ğŸ”œ<a href="/2018/10/20/docker/docker-elk/">åŸºäºdockeréƒ¨ç½²ELK</a></div></nav><div id="base-discus"><div id="disqus_thread"></div><script>var disqus_shortname = 'barudisshu-github-io';
var disqus_identifier = '2018/10/21/spark/spark-zookeeper-1/';
var disqus_title = 'CentOS 7.5 æ­å»ºZookeeperé›†ç¾¤ä¸å‘½ä»¤è¡Œæ“ä½œ';
var disqus_url = 'https://galudisu.info/2018/10/21/spark/spark-zookeeper-1/';
(function () {
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async>  </script></div></div></div><footer class="base-footer"><div class="footer-wrapper"><span>Â©2016 - 2025 <a href="https://galudisu.info">barudisshu</a>, unless otherwise noted.</span></div></footer><div class="dom-ready">
<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>

<link rel="stylesheet" href="//cdn.bootcss.com/pace/1.0.2/themes/green/pace-theme-flash.min.css">

<script src="/js/base.js"></script>

<script src="/js/rabbit-lyrics.js"></script>
</div></body></html>