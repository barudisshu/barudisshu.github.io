<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><title>Circuit Breaker</title>
<link rel="stylesheet" href="/css/layout.css">
<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="/css/vendors/rabbit-lyrics.css">
<link rel="shortcut icon" href="/img/favicon.ico"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•" type="application/atom+xml">
</head><body><header class="base-menu"><div class="menu-wrapper"><div class="menu-layout-bg"></div><nav class="menu-content"><ul class="menu-list"><li class="menu-item"><a class="menu-link" href="/">ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•</a></li><li class="menu-item"><a class="menu-link" href="/archives/">Archives</a></li><li class="menu-item"><a class="menu-link" target="_blank" rel="noopener" href="http://weibo.com/u/2360401155">Weibo</a></li><li class="menu-item"><a class="menu-link" href="/about">About</a></li><li class="menu-item"><a class="menu-link" href="/atom.xml">Rss</a></li></ul></nav></div></header><header class="base-mobile-menu"><div class="mobile-menu-wrapper"><div class="menu-layout-bg"></div><nav class="menu-content"><ul class="menu-list"><li class="menu-item"><a class="menu-link" href="/">ç®€å•æ˜“æ‡‚ã®ç°ä»£é­”æ³•</a></li><li class="menu-item"><a class="menu-link" href="/archives/">Archives</a></li><li class="menu-item"><a class="menu-link" target="_blank" rel="noopener" href="http://weibo.com/u/2360401155">Weibo</a></li><li class="menu-item"><a class="menu-link" href="/about">About</a></li><li class="menu-item"><a class="menu-link" href="/atom.xml">Rss</a></li></ul></nav><div class="toggle-menu" id="mobile-menu-toggle"><span class="menu-bar"></span><span class="menu-bar"> </span><span class="menu-bar"></span></div></div></header><div class="base-content"><div class="base-content-main"><article class="article-main"><h1 class="article-title">Circuit Breaker</h1><div class="article-meta"><p class="meta-item meta-time"><span class="meta-item-title"></span><i class="icon-calendar"> </i>2017-12-29</p><p class="meta-item meta-tag"><span class="meta-item-title"></span><i class="icon-tag"> </i><a class="tag-link" href="/tags/circuit-breaker-reactivemanifesto/">circuit-breaker, reactivemanifesto</a></p></div><div class="article-content"><p>ç†”æ–­å™¨(circuit breaker)åŒ…å«åœ¨ç”µè·¯è®¾å¤‡ä¸­ï¼Œç”¨äºé˜²æ­¢è¿‡è½½æˆ–çŸ­è·¯çš„ç»„ä»¶ã€‚å¸¸è§äºæ´—è¡£æœºã€ç”µçƒ­æ°´å£¶ã€çƒ¤æœºç­‰ã€‚ä»Šå¤©æ‰€è®²çš„æ¯”è¿™ä¸ªç¨å¾®å¤æ‚ä¸€äº›ã€‚</p>
<span id="more"></span>
<p><img src="/img/philosophy/circuit-breaker/circuit_breaker_state_diagram.gif" alt="circuit-breaker"></p>
<p>ä¸€ä¸ªç†”æ–­å™¨åŒ…å«ä¸‹é¢çš„åŠŸèƒ½ï¼š</p>
<ul>
<li>å½“æ‰€æœ‰æƒ…å†µæ­£å¸¸ï¼Œå®ƒçš„çŠ¶æ€ä¸º<code>closed</code>ï¼Œè®©ç”µæµ(electricity)æˆ–æ•°æ®(data)æµé€šã€‚</li>
<li>å½“æ¢æµ‹åˆ°è¿‡è½½(overload)æˆ–çŸ­è·¯(short circuit)ï¼Œç†”æ–­å™¨è·³é—¸(<code>trips</code>)è¿›å…¥<code>open</code>çŠ¶æ€ï¼Œä¸è®©ä»»ä½•ä¸œè¥¿æµé€šã€‚</li>
<li>ä¸€æ®µæ—¶é—´åï¼Œç†”æ–­å™¨ä¼šè‡ªåŠ¨è¿›å…¥<code>half-open</code>çŠ¶æ€ï¼Œæ¢æµ‹(probing)æ˜¯å¦æ¢å¤æ­£å¸¸ã€‚å¦‚æœç”µæµ(æˆ–æ•°æ®æµ)æ­£å¸¸ï¼Œç†”æ–­å™¨è¿›å…¥<code>open</code>çŠ¶æ€ã€‚</li>
</ul>
<p>å› ä¸ºè¿œç¨‹è°ƒç”¨å’Œå†…å­˜(in-memory)è°ƒç”¨ä¸åŒï¼Œè¿œç¨‹è°ƒç”¨ä¼šå‡ºç°è¶…æ—¶å’ŒæŒ‚æ‰çš„æƒ…å†µã€‚è½¯ä»¶æœåŠ¡é—´éœ€è¦æä¾›ä¸€ç§å“åº”å¼çš„è®¾è®¡ã€‚Michael Nygard å‘è¡¨äº†ä¸€ç¯‡æ–‡ç« é˜è¿°äº†<code>Circuit Breaker pattern</code>æ¥é˜²æŠ¤è¿™ç§ç¾éš¾æ€§çš„çº§è”å‘ç”Ÿã€‚</p>
<p>å’Œç”µè·¯ä¸Šçš„ç†”æ–­å™¨åˆäº›è®¸ä¸åŒï¼Œç†”æ–­å™¨æ¨¡å¼åŒ…å«ä¸‹é¢çŠ¶æ€æ”¹å˜çš„è§„åˆ™ï¼š</p>
<ul>
<li>åœ¨<code>closed</code>çŠ¶æ€ï¼Œç†”æ–­å™¨ç»Ÿè®¡å¤±è´¥çš„æ¬¡æ•°æˆ– äº‹å…ˆå®šä¹‰å¥½çš„<code>callTimeout</code>çš„æ¬¡æ•°ã€‚å¦‚æœå¤±è´¥çš„æ¬¡æ•°åˆ°è¾¾è®¾å®šçš„é˜ˆå€¼(maxFailures or thresholds)ï¼Œè·³é—¸ã€‚ä»»ä½•è°ƒç”¨éƒ½åº”è¯¥åœ¨è®¡æ•°(counter)é‡ç½®ä¸º0æ—¶æ‰èƒ½æˆåŠŸè®¿é—®ã€‚</li>
<li>åœ¨<code>open</code>çŠ¶æ€ï¼Œç†”æ–­å™¨é—²ç½®(idles until)æ‰§è¡Œåˆ°é…ç½®çš„<code>resetTimeout</code>æ—¶é—´ï¼Œéšåè¿›å…¥<code>half-open</code>çŠ¶æ€ã€‚</li>
<li>åœ¨<code>half-open</code>çŠ¶æ€ï¼Œå¦‚æœç¬¬ä¸€æ¬¡å°è¯•è°ƒç”¨ä»ç„¶å¤±è´¥ï¼Œå®ƒé‡æ–°è·³é—¸åˆ°<code>open</code>çŠ¶æ€ï¼›å¦‚æœç¬¬ä¸€æ¬¡è°ƒç”¨æˆåŠŸäº†ï¼Œç†”æ–­å™¨é‡ç½®ä¸º<code>closed</code>çŠ¶æ€ï¼Œ <code>restTimeout</code>è¢«é‡ç½®ã€‚</li>
</ul>
<p><img src="/img/philosophy/circuit-breaker/state.png" alt="å›¾ä¾‹"></p>
<h2 id="Reactive-Design"><a class="header-anchor" href="#Reactive-Design">Â¶</a>Reactive Design</h2>
<p>æœ€æ—©çš„å“åº”å¼å®£è¨€å®£å¸ƒäº2013å¹´6æœˆã€‚å®ƒæ˜¯å“åº”å¼åº”ç”¨çš„è½¯ä»¶æ¶æ„æè¿°ã€‚å®ƒåŒ…å«ä¸‹é¢4ä¸ªç‰¹ç‚¹ï¼š</p>
<ul>
<li><em>Responsive</em> â€”â€” React to users			(å¿«é€Ÿæ£€æµ‹å¹¶é«˜æ•ˆå¤„ç†é—®é¢˜)</li>
<li><em>Scalable(Elastic)</em> â€”â€” React to load		(å¼¹æ€§æ§åˆ¶ï¼Œå¤§éƒ¨åˆ†å®ç°ä¾èµ–äºç¡¬ä»¶å’Œè½¯ä»¶å¹³å°)</li>
<li><em>Resilient</em> â€”â€” React to failure			(æœ‰å›å¤ï¼Œå—æ§åˆ¶ï¼Œéš”ç¦»ï¼Œå§”æ´¾)</li>
<li><em>Event-driven</em> â€”â€” React to events			(å¼‚æ­¥æ¶ˆæ¯ï¼Œç¡®ä¿æ¾è€¦åˆï¼Œéš”ç¦»ï¼Œä½ç½®é€æ˜ã€‚éé˜»å¡çš„äº¤äº’æœåŠ¡)</li>
</ul>
<p>ä¸€äº›å®ç°æ–¹å¼ï¼š</p>
<ol>
<li>è¯·æ±‚å›å¤é“¾è·¯ï¼š</li>
</ol>
<p><img src="/img/philosophy/circuit-breaker/chain.png" alt="RRC"></p>
<ol start="2">
<li>æˆ‘ä»¬çš„è®¾è®¡ï¼š</li>
</ol>
<p><img src="/img/philosophy/circuit-breaker/%E7%9B%91%E7%AE%A1%E7%AD%96%E7%95%A5.png" alt="supervisor"></p>
</div></article><nav class="article-nav"><div class="article-nav-prev">ğŸ”™<a href="/2018/01/10/cassandra/cassandra-beginning/">Cassandra å®‰è£…å…¥é—¨</a></div><div class="article-nav-next">ğŸ”œ<a href="/2017/11/22/musics/audio-player-nest/">éŸ³ä¹æ’­æ”¾å™¨</a></div></nav><div id="base-discus"><div id="disqus_thread"></div><script>var disqus_shortname = 'barudisshu-github-io';
var disqus_identifier = '2017/12/29/philosophy/circuit-breaker/';
var disqus_title = 'Circuit Breaker';
var disqus_url = 'https://galudisu.info/2017/12/29/philosophy/circuit-breaker/';
(function () {
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async>  </script></div></div></div><footer class="base-footer"><div class="footer-wrapper"><span>Â©2016 - 2025 <a href="https://galudisu.info">barudisshu</a>, unless otherwise noted.</span></div></footer><div class="dom-ready">
<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>

<link rel="stylesheet" href="//cdn.bootcss.com/pace/1.0.2/themes/green/pace-theme-flash.min.css">

<script src="/js/base.js"></script>

<script src="/js/rabbit-lyrics.js"></script>
</div></body></html>